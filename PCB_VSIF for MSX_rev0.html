<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #b4ff03;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html, body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
    box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 10px 10px 10px 0px;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 5px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
}

.bom th, .bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th, .dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #aaa;
}

.dark .bom tr.checked {
  color: #666;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 25px;
}

.bom .Description {
  width: 10%;
}

.bom .Part {
  width: 10%;
}

.bom .Value {
  width: 15%;
}

.bom .Quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before, .bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal, .gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.dark .statsbtn, .dark .savebtn, .dark .menubtn, .dark .iobtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 10px 10px 10px 0px;
}

.menu-content {
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn, .menu:hover .iobtn, .menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid, .dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  width: 100%;
  height: 100%;
  background-color: white;
  transition: background-color 0.3s;
}

#top {
  height: 78px;
  border-bottom: 2px solid black;
}

.dark #top {
  border-bottom: 2px solid #ccc;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas, #backcanvas {
    touch-action: none;
}

 
  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
! function (a, b) {
  "object" == typeof exports && "undefined" != typeof module ? module.exports = b() : "function" == typeof define && define.amd ? define(b) : a.PointerEventsPolyfill = b()
}(this, function () {
  "use strict";

  function a(a, b) {
    b = b || Object.create(null);
    var c = document.createEvent("Event");
    c.initEvent(a, b.bubbles || !1, b.cancelable || !1);
    for (var d, e = 2; e < m.length; e++) d = m[e], c[d] = b[d] || n[e];
    c.buttons = b.buttons || 0;
    var f = 0;
    return f = b.pressure && c.buttons ? b.pressure : c.buttons ? .5 : 0, c.x = c.clientX, c.y = c.clientY, c.pointerId = b.pointerId || 0, c.width = b.width || 0, c.height = b.height || 0, c.pressure = f, c.tiltX = b.tiltX || 0, c.tiltY = b.tiltY || 0, c.twist = b.twist || 0, c.tangentialPressure = b.tangentialPressure || 0, c.pointerType = b.pointerType || "", c.hwTimestamp = b.hwTimestamp || 0, c.isPrimary = b.isPrimary || !1, c
  }

  function b() {
    this.array = [], this.size = 0
  }

  function c(a, b, c, d) {
    this.addCallback = a.bind(d), this.removeCallback = b.bind(d), this.changedCallback = c.bind(d), A && (this.observer = new A(this.mutationWatcher.bind(this)))
  }

  function d(a) {
    return "body /shadow-deep/ " + e(a)
  }

  function e(a) {
    return '[touch-action="' + a + '"]'
  }

  function f(a) {
    return "{ -ms-touch-action: " + a + "; touch-action: " + a + "; }"
  }

  function g() {
    if (F) {
      D.forEach(function (a) {
        String(a) === a ? (E += e(a) + f(a) + "\n", G && (E += d(a) + f(a) + "\n")) : (E += a.selectors.map(e) + f(a.rule) + "\n", G && (E += a.selectors.map(d) + f(a.rule) + "\n"))
      });
      var a = document.createElement("style");
      a.textContent = E, document.head.appendChild(a)
    }
  }

  function h() {
    if (!window.PointerEvent) {
      if (window.PointerEvent = a, window.navigator.msPointerEnabled) {
        var b = window.navigator.msMaxTouchPoints;
        Object.defineProperty(window.navigator, "maxTouchPoints", {
          value: b,
          enumerable: !0
        }), u.registerSource("ms", _)
      } else Object.defineProperty(window.navigator, "maxTouchPoints", {
        value: 0,
        enumerable: !0
      }), u.registerSource("mouse", N), void 0 !== window.ontouchstart && u.registerSource("touch", V);
      u.register(document)
    }
  }

  function i(a) {
    if (!u.pointermap.has(a)) {
      var b = new Error("InvalidPointerId");
      throw b.name = "InvalidPointerId", b
    }
  }

  function j(a) {
    for (var b = a.parentNode; b && b !== a.ownerDocument;) b = b.parentNode;
    if (!b) {
      var c = new Error("InvalidStateError");
      throw c.name = "InvalidStateError", c
    }
  }

  function k(a) {
    var b = u.pointermap.get(a);
    return 0 !== b.buttons
  }

  function l() {
    window.Element && !Element.prototype.setPointerCapture && Object.defineProperties(Element.prototype, {
      setPointerCapture: {
        value: W
      },
      releasePointerCapture: {
        value: X
      },
      hasPointerCapture: {
        value: Y
      }
    })
  }
  var m = ["bubbles", "cancelable", "view", "detail", "screenX", "screenY", "clientX", "clientY", "ctrlKey", "altKey", "shiftKey", "metaKey", "button", "relatedTarget", "pageX", "pageY"],
    n = [!1, !1, null, null, 0, 0, 0, 0, !1, !1, !1, !1, 0, null, 0, 0],
    o = window.Map && window.Map.prototype.forEach,
    p = o ? Map : b;
  b.prototype = {
    set: function (a, b) {
      return void 0 === b ? this["delete"](a) : (this.has(a) || this.size++, void(this.array[a] = b))
    },
    has: function (a) {
      return void 0 !== this.array[a]
    },
    "delete": function (a) {
      this.has(a) && (delete this.array[a], this.size--)
    },
    get: function (a) {
      return this.array[a]
    },
    clear: function () {
      this.array.length = 0, this.size = 0
    },
    forEach: function (a, b) {
      return this.array.forEach(function (c, d) {
        a.call(b, c, d, this)
      }, this)
    }
  };
  var q = ["bubbles", "cancelable", "view", "detail", "screenX", "screenY", "clientX", "clientY", "ctrlKey", "altKey", "shiftKey", "metaKey", "button", "relatedTarget", "buttons", "pointerId", "width", "height", "pressure", "tiltX", "tiltY", "pointerType", "hwTimestamp", "isPrimary", "type", "target", "currentTarget", "which", "pageX", "pageY", "timeStamp"],
    r = [!1, !1, null, null, 0, 0, 0, 0, !1, !1, !1, !1, 0, null, 0, 0, 0, 0, 0, 0, 0, "", 0, !1, "", null, null, 0, 0, 0, 0],
    s = {
      pointerover: 1,
      pointerout: 1,
      pointerenter: 1,
      pointerleave: 1
    },
    t = "undefined" != typeof SVGElementInstance,
    u = {
      pointermap: new p,
      eventMap: Object.create(null),
      captureInfo: Object.create(null),
      eventSources: Object.create(null),
      eventSourceList: [],
      registerSource: function (a, b) {
        var c = b,
          d = c.events;
        d && (d.forEach(function (a) {
          c[a] && (this.eventMap[a] = c[a].bind(c))
        }, this), this.eventSources[a] = c, this.eventSourceList.push(c))
      },
      register: function (a) {
        for (var b, c = this.eventSourceList.length, d = 0; d < c && (b = this.eventSourceList[d]); d++)
          b.register.call(b, a)
      },
      unregister: function (a) {
        for (var b, c = this.eventSourceList.length, d = 0; d < c && (b = this.eventSourceList[d]); d++)
          b.unregister.call(b, a)
      },
      contains: function (a, b) {
        try {
          return a.contains(b)
        } catch (c) {
          return !1
        }
      },
      down: function (a) {
        a.bubbles = !0, this.fireEvent("pointerdown", a)
      },
      move: function (a) {
        a.bubbles = !0, this.fireEvent("pointermove", a)
      },
      up: function (a) {
        a.bubbles = !0, this.fireEvent("pointerup", a)
      },
      enter: function (a) {
        a.bubbles = !1, this.fireEvent("pointerenter", a)
      },
      leave: function (a) {
        a.bubbles = !1, this.fireEvent("pointerleave", a)
      },
      over: function (a) {
        a.bubbles = !0, this.fireEvent("pointerover", a)
      },
      out: function (a) {
        a.bubbles = !0, this.fireEvent("pointerout", a)
      },
      cancel: function (a) {
        a.bubbles = !0, this.fireEvent("pointercancel", a)
      },
      leaveOut: function (a) {
        this.out(a), this.propagate(a, this.leave, !1)
      },
      enterOver: function (a) {
        this.over(a), this.propagate(a, this.enter, !0)
      },
      eventHandler: function (a) {
        if (!a._handledByPE) {
          var b = a.type,
            c = this.eventMap && this.eventMap[b];
          c && c(a), a._handledByPE = !0
        }
      },
      listen: function (a, b) {
        b.forEach(function (b) {
          this.addEvent(a, b)
        }, this)
      },
      unlisten: function (a, b) {
        b.forEach(function (b) {
          this.removeEvent(a, b)
        }, this)
      },
      addEvent: function (a, b) {
        a.addEventListener(b, this.boundHandler)
      },
      removeEvent: function (a, b) {
        a.removeEventListener(b, this.boundHandler)
      },
      makeEvent: function (b, c) {
        this.captureInfo[c.pointerId] && (c.relatedTarget = null);
        var d = new a(b, c);
        return c.preventDefault && (d.preventDefault = c.preventDefault), d._target = d._target || c.target, d
      },
      fireEvent: function (a, b) {
        var c = this.makeEvent(a, b);
        return this.dispatchEvent(c)
      },
      cloneEvent: function (a) {
        for (var b, c = Object.create(null), d = 0; d < q.length; d++) b = q[d], c[b] = a[b] || r[d], !t || "target" !== b && "relatedTarget" !== b || c[b] instanceof SVGElementInstance && (c[b] = c[b].correspondingUseElement);
        return a.preventDefault && (c.preventDefault = function () {
          a.preventDefault()
        }), c
      },
      getTarget: function (a) {
        var b = this.captureInfo[a.pointerId];
        return b ? a._target !== b && a.type in s ? void 0 : b : a._target
      },
      propagate: function (a, b, c) {
        for (var d = a.target, e = []; d !== document && !d.contains(a.relatedTarget);)
          if (e.push(d), d = d.parentNode, !d) return;
        c && e.reverse(), e.forEach(function (c) {
          a.target = c, b.call(this, a)
        }, this)
      },
      setCapture: function (b, c, d) {
        this.captureInfo[b] && this.releaseCapture(b, d), this.captureInfo[b] = c, this.implicitRelease = this.releaseCapture.bind(this, b, d), document.addEventListener("pointerup", this.implicitRelease), document.addEventListener("pointercancel", this.implicitRelease);
        var e = new a("gotpointercapture");
        e.pointerId = b, e._target = c, d || this.asyncDispatchEvent(e)
      },
      releaseCapture: function (b, c) {
        var d = this.captureInfo[b];
        if (d) {
          this.captureInfo[b] = void 0, document.removeEventListener("pointerup", this.implicitRelease), document.removeEventListener("pointercancel", this.implicitRelease);
          var e = new a("lostpointercapture");
          e.pointerId = b, e._target = d, c || this.asyncDispatchEvent(e)
        }
      },
      dispatchEvent: /*scope.external.dispatchEvent || */ function (a) {
        var b = this.getTarget(a);
        if (b) return b.dispatchEvent(a)
      },
      asyncDispatchEvent: function (a) {
        requestAnimationFrame(this.dispatchEvent.bind(this, a))
      }
    };
  u.boundHandler = u.eventHandler.bind(u);
  var v = {
      shadow: function (a) {
        if (a) return a.shadowRoot || a.webkitShadowRoot
      },
      canTarget: function (a) {
        return a && Boolean(a.elementFromPoint)
      },
      targetingShadow: function (a) {
        var b = this.shadow(a);
        if (this.canTarget(b)) return b
      },
      olderShadow: function (a) {
        var b = a.olderShadowRoot;
        if (!b) {
          var c = a.querySelector("shadow");
          c && (b = c.olderShadowRoot)
        }
        return b
      },
      allShadows: function (a) {
        for (var b = [], c = this.shadow(a); c;) b.push(c), c = this.olderShadow(c);
        return b
      },
      searchRoot: function (a, b, c) {
        if (a) {
          var d, e, f = a.elementFromPoint(b, c);
          for (e = this.targetingShadow(f); e;) {
            if (d = e.elementFromPoint(b, c)) {
              var g = this.targetingShadow(d);
              return this.searchRoot(g, b, c) || d
            }
            e = this.olderShadow(e)
          }
          return f
        }
      },
      owner: function (a) {
        for (var b = a; b.parentNode;) b = b.parentNode;
        return b.nodeType !== Node.DOCUMENT_NODE && b.nodeType !== Node.DOCUMENT_FRAGMENT_NODE && (b = document), b
      },
      findTarget: function (a) {
        var b = a.clientX,
          c = a.clientY,
          d = this.owner(a.target);
        return d.elementFromPoint(b, c) || (d = document), this.searchRoot(d, b, c)
      }
    },
    w = Array.prototype.forEach.call.bind(Array.prototype.forEach),
    x = Array.prototype.map.call.bind(Array.prototype.map),
    y = Array.prototype.slice.call.bind(Array.prototype.slice),
    z = Array.prototype.filter.call.bind(Array.prototype.filter),
    A = window.MutationObserver || window.WebKitMutationObserver,
    B = "[touch-action]",
    C = {
      subtree: !0,
      childList: !0,
      attributes: !0,
      attributeOldValue: !0,
      attributeFilter: ["touch-action"]
    };
  c.prototype = {
    watchSubtree: function (a) {
      //
      this.observer && v.canTarget(a) && this.observer.observe(a, C)
    },
    enableOnSubtree: function (a) {
      this.watchSubtree(a), a === document && "complete" !== document.readyState ? this.installOnLoad() : this.installNewSubtree(a)
    },
    installNewSubtree: function (a) {
      w(this.findElements(a), this.addElement, this)
    },
    findElements: function (a) {
      return a.querySelectorAll ? a.querySelectorAll(B) : []
    },
    removeElement: function (a) {
      this.removeCallback(a)
    },
    addElement: function (a) {
      this.addCallback(a)
    },
    elementChanged: function (a, b) {
      this.changedCallback(a, b)
    },
    concatLists: function (a, b) {
      return a.concat(y(b))
    },
    installOnLoad: function () {
      document.addEventListener("readystatechange", function () {
        "complete" === document.readyState && this.installNewSubtree(document)
      }.bind(this))
    },
    isElement: function (a) {
      return a.nodeType === Node.ELEMENT_NODE
    },
    flattenMutationTree: function (a) {
      var b = x(a, this.findElements, this);
      return b.push(z(a, this.isElement)), b.reduce(this.concatLists, [])
    },
    mutationWatcher: function (a) {
      a.forEach(this.mutationHandler, this)
    },
    mutationHandler: function (a) {
      if ("childList" === a.type) {
        var b = this.flattenMutationTree(a.addedNodes);
        b.forEach(this.addElement, this);
        var c = this.flattenMutationTree(a.removedNodes);
        c.forEach(this.removeElement, this)
      } else "attributes" === a.type && this.elementChanged(a.target, a.oldValue)
    }
  };
  var D = ["none", "auto", "pan-x", "pan-y", {
      rule: "pan-x pan-y",
      selectors: ["pan-x pan-y", "pan-y pan-x"]
    }],
    E = "",
    F = window.PointerEvent || window.MSPointerEvent,
    G = !window.ShadowDOMPolyfill && document.head.createShadowRoot,
    H = u.pointermap,
    I = 25,
    J = [1, 4, 2, 8, 16],
    K = !1;
  try {
    K = 1 === new MouseEvent("test", {
      buttons: 1
    }).buttons
  } catch (L) {}
  var M, N = {
      POINTER_ID: 1,
      POINTER_TYPE: "mouse",
      events: ["mousedown", "mousemove", "mouseup", "mouseover", "mouseout"],
      register: function (a) {
        u.listen(a, this.events)
      },
      unregister: function (a) {
        u.unlisten(a, this.events)
      },
      lastTouches: [],
      isEventSimulatedFromTouch: function (a) {
        for (var b, c = this.lastTouches, d = a.clientX, e = a.clientY, f = 0, g = c.length; f < g && (b = c[f]); f++) {
          var h = Math.abs(d - b.x),
            i = Math.abs(e - b.y);
          if (h <= I && i <= I) return !0
        }
      },
      prepareEvent: function (a) {
        var b = u.cloneEvent(a),
          c = b.preventDefault;
        return b.preventDefault = function () {
          a.preventDefault(), c()
        }, b.pointerId = this.POINTER_ID, b.isPrimary = !0, b.pointerType = this.POINTER_TYPE, b
      },
      prepareButtonsForMove: function (a, b) {
        var c = H.get(this.POINTER_ID);
        0 !== b.which && c ? a.buttons = c.buttons : a.buttons = 0, b.buttons = a.buttons
      },
      mousedown: function (a) {
        if (!this.isEventSimulatedFromTouch(a)) {
          var b = H.get(this.POINTER_ID),
            c = this.prepareEvent(a);
          K || (c.buttons = J[c.button], b && (c.buttons |= b.buttons), a.buttons = c.buttons), H.set(this.POINTER_ID, a), b && 0 !== b.buttons ? u.move(c) : u.down(c)
        }
      },
      mousemove: function (a) {
        if (!this.isEventSimulatedFromTouch(a)) {
          var b = this.prepareEvent(a);
          K || this.prepareButtonsForMove(b, a), b.button = -1, H.set(this.POINTER_ID, a), u.move(b)
        }
      },
      mouseup: function (a) {
        if (!this.isEventSimulatedFromTouch(a)) {
          var b = H.get(this.POINTER_ID),
            c = this.prepareEvent(a);
          if (!K) {
            var d = J[c.button];
            c.buttons = b ? b.buttons & ~d : 0, a.buttons = c.buttons
          }
          H.set(this.POINTER_ID, a),
            c.buttons &= ~J[c.button], 0 === c.buttons ? u.up(c) : u.move(c)
        }
      },
      mouseover: function (a) {
        if (!this.isEventSimulatedFromTouch(a)) {
          var b = this.prepareEvent(a);
          K || this.prepareButtonsForMove(b, a), b.button = -1, H.set(this.POINTER_ID, a), u.enterOver(b)
        }
      },
      mouseout: function (a) {
        if (!this.isEventSimulatedFromTouch(a)) {
          var b = this.prepareEvent(a);
          K || this.prepareButtonsForMove(b, a), b.button = -1, u.leaveOut(b)
        }
      },
      cancel: function (a) {
        var b = this.prepareEvent(a);
        u.cancel(b), this.deactivateMouse()
      },
      deactivateMouse: function () {
        H["delete"](this.POINTER_ID)
      }
    },
    O = u.captureInfo,
    P = v.findTarget.bind(v),
    Q = v.allShadows.bind(v),
    R = u.pointermap,
    S = 2500,
    T = 200,
    U = "touch-action",
    V = {
      events: ["touchstart", "touchmove", "touchend", "touchcancel"],
      register: function (a) {
        M.enableOnSubtree(a)
      },
      unregister: function () {},
      elementAdded: function (a) {
        var b = a.getAttribute(U),
          c = this.touchActionToScrollType(b);
        c && (a._scrollType = c, u.listen(a, this.events),
          Q(a).forEach(function (a) {
            a._scrollType = c, u.listen(a, this.events)
          }, this))
      },
      elementRemoved: function (a) {
        a._scrollType = void 0, u.unlisten(a, this.events),
          Q(a).forEach(function (a) {
            a._scrollType = void 0, u.unlisten(a, this.events)
          }, this)
      },
      elementChanged: function (a, b) {
        var c = a.getAttribute(U),
          d = this.touchActionToScrollType(c),
          e = this.touchActionToScrollType(b);
        d && e ? (a._scrollType = d, Q(a).forEach(function (a) {
          a._scrollType = d
        }, this)) : e ? this.elementRemoved(a) : d && this.elementAdded(a)
      },
      scrollTypes: {
        EMITTER: "none",
        XSCROLLER: "pan-x",
        YSCROLLER: "pan-y",
        SCROLLER: /^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/
      },
      touchActionToScrollType: function (a) {
        var b = a,
          c = this.scrollTypes;
        return "none" === b ? "none" : b === c.XSCROLLER ? "X" : b === c.YSCROLLER ? "Y" : c.SCROLLER.exec(b) ? "XY" : void 0
      },
      POINTER_TYPE: "touch",
      firstTouch: null,
      isPrimaryTouch: function (a) {
        return this.firstTouch === a.identifier
      },
      setPrimaryTouch: function (a) {
        (0 === R.size || 1 === R.size && R.has(1)) && (this.firstTouch = a.identifier, this.firstXY = {
          X: a.clientX,
          Y: a.clientY
        }, this.scrolling = !1, this.cancelResetClickCount())
      },
      removePrimaryPointer: function (a) {
        a.isPrimary && (this.firstTouch = null, this.firstXY = null, this.resetClickCount())
      },
      clickCount: 0,
      resetId: null,
      resetClickCount: function () {
        var a = function () {
          this.clickCount = 0, this.resetId = null
        }.bind(this);
        this.resetId = setTimeout(a, T)
      },
      cancelResetClickCount: function () {
        this.resetId && clearTimeout(this.resetId)
      },
      typeToButtons: function (a) {
        var b = 0;
        return "touchstart" !== a && "touchmove" !== a || (b = 1), b
      },
      touchToPointer: function (a) {
        var b = this.currentTouchEvent,
          c = u.cloneEvent(a),
          d = c.pointerId = a.identifier + 2;
        c.target = O[d] || P(c), c.bubbles = !0, c.cancelable = !0, c.detail = this.clickCount, c.button = 0, c.buttons = this.typeToButtons(b.type), c.width = 2 * (a.radiusX || a.webkitRadiusX || 0), c.height = 2 * (a.radiusY || a.webkitRadiusY || 0), c.pressure = a.force || a.webkitForce || .5, c.isPrimary = this.isPrimaryTouch(a), c.pointerType = this.POINTER_TYPE,
          c.altKey = b.altKey, c.ctrlKey = b.ctrlKey, c.metaKey = b.metaKey, c.shiftKey = b.shiftKey;
        var e = this;
        return c.preventDefault = function () {
          e.scrolling = !1, e.firstXY = null, b.preventDefault()
        }, c
      },
      processTouches: function (a, b) {
        var c = a.changedTouches;
        this.currentTouchEvent = a;
        for (var d, e = 0; e < c.length; e++) d = c[e], b.call(this, this.touchToPointer(d))
      },
      shouldScroll: function (a) {
        if (this.firstXY) {
          var b, c = a.currentTarget._scrollType;
          if ("none" === c)
            b = !1;
          else if ("XY" === c)
            b = !0;
          else {
            var d = a.changedTouches[0],
              e = c,
              f = "Y" === c ? "X" : "Y",
              g = Math.abs(d["client" + e] - this.firstXY[e]),
              h = Math.abs(d["client" + f] - this.firstXY[f]);
            b = g >= h
          }
          return this.firstXY = null, b
        }
      },
      findTouch: function (a, b) {
        for (var c, d = 0, e = a.length; d < e && (c = a[d]); d++)
          if (c.identifier === b) return !0
      },
      vacuumTouches: function (a) {
        var b = a.touches;
        if (R.size >= b.length) {
          var c = [];
          R.forEach(function (a, d) {
            if (1 !== d && !this.findTouch(b, d - 2)) {
              var e = a.out;
              c.push(e)
            }
          }, this), c.forEach(this.cancelOut, this)
        }
      },
      touchstart: function (a) {
        this.vacuumTouches(a), this.setPrimaryTouch(a.changedTouches[0]), this.dedupSynthMouse(a), this.scrolling || (this.clickCount++, this.processTouches(a, this.overDown))
      },
      overDown: function (a) {
        R.set(a.pointerId, {
          target: a.target,
          out: a,
          outTarget: a.target
        }), u.enterOver(a), u.down(a)
      },
      touchmove: function (a) {
        this.scrolling || (this.shouldScroll(a) ? (this.scrolling = !0, this.touchcancel(a)) : (a.preventDefault(), this.processTouches(a, this.moveOverOut)))
      },
      moveOverOut: function (a) {
        var b = a,
          c = R.get(b.pointerId);
        if (c) {
          var d = c.out,
            e = c.outTarget;
          u.move(b), d && e !== b.target && (d.relatedTarget = b.target, b.relatedTarget = e,
            d.target = e, b.target ? (u.leaveOut(d), u.enterOver(b)) : (
              b.target = e, b.relatedTarget = null, this.cancelOut(b))), c.out = b, c.outTarget = b.target
        }
      },
      touchend: function (a) {
        this.dedupSynthMouse(a), this.processTouches(a, this.upOut)
      },
      upOut: function (a) {
        this.scrolling || (u.up(a), u.leaveOut(a)), this.cleanUpPointer(a)
      },
      touchcancel: function (a) {
        this.processTouches(a, this.cancelOut)
      },
      cancelOut: function (a) {
        u.cancel(a), u.leaveOut(a), this.cleanUpPointer(a)
      },
      cleanUpPointer: function (a) {
        R["delete"](a.pointerId), this.removePrimaryPointer(a)
      },
      dedupSynthMouse: function (a) {
        var b = N.lastTouches,
          c = a.changedTouches[0];
        if (this.isPrimaryTouch(c)) {
          var d = {
            x: c.clientX,
            y: c.clientY
          };
          b.push(d);
          var e = function (a, b) {
            var c = a.indexOf(b);
            c > -1 && a.splice(c, 1)
          }.bind(null, b, d);
          setTimeout(e, S)
        }
      }
    };
  M = new c(V.elementAdded, V.elementRemoved, V.elementChanged, V);
  var W, X, Y, Z = u.pointermap,
    $ = window.MSPointerEvent && "number" == typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,
    _ = {
      events: ["MSPointerDown", "MSPointerMove", "MSPointerUp", "MSPointerOut", "MSPointerOver", "MSPointerCancel", "MSGotPointerCapture", "MSLostPointerCapture"],
      register: function (a) {
        u.listen(a, this.events)
      },
      unregister: function (a) {
        u.unlisten(a, this.events)
      },
      POINTER_TYPES: ["", "unavailable", "touch", "pen", "mouse"],
      prepareEvent: function (a) {
        var b = a;
        return $ && (b = u.cloneEvent(a), b.pointerType = this.POINTER_TYPES[a.pointerType]), b
      },
      cleanup: function (a) {
        Z["delete"](a)
      },
      MSPointerDown: function (a) {
        Z.set(a.pointerId, a);
        var b = this.prepareEvent(a);
        u.down(b)
      },
      MSPointerMove: function (a) {
        var b = this.prepareEvent(a);
        u.move(b)
      },
      MSPointerUp: function (a) {
        var b = this.prepareEvent(a);
        u.up(b), this.cleanup(a.pointerId)
      },
      MSPointerOut: function (a) {
        var b = this.prepareEvent(a);
        u.leaveOut(b)
      },
      MSPointerOver: function (a) {
        var b = this.prepareEvent(a);
        u.enterOver(b)
      },
      MSPointerCancel: function (a) {
        var b = this.prepareEvent(a);
        u.cancel(b), this.cleanup(a.pointerId)
      },
      MSLostPointerCapture: function (a) {
        var b = u.makeEvent("lostpointercapture", a);
        u.dispatchEvent(b)
      },
      MSGotPointerCapture: function (a) {
        var b = u.makeEvent("gotpointercapture", a);
        u.dispatchEvent(b)
      }
    },
    aa = window.navigator;
  aa.msPointerEnabled ? (W = function (a) {
    i(a), j(this), k(a) && (u.setCapture(a, this, !0), this.msSetPointerCapture(a))
  }, X = function (a) {
    i(a), u.releaseCapture(a, !0), this.msReleasePointerCapture(a)
  }) : (W = function (a) {
    i(a), j(this), k(a) && u.setCapture(a, this)
  }, X = function (a) {
    i(a), u.releaseCapture(a)
  }), Y = function (a) {
    return !!u.captureInfo[a]
  }, g(), h(), l();
  var ba = {
    dispatcher: u,
    Installer: c,
    PointerEvent: a,
    PointerMap: p,
    targetFinding: v
  };
  return ba
});
///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"show_fabrication":false,"redraw_on_drag":true,"highlight_pin1":false,"extra_fields":[],"dark_mode":false,"bom_view":"left-right","board_rotation":0,"checkboxes":"Sourced,Placed","show_silkscreen":true,"show_pads":true,"layer_view":"FB"};
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = {"ibom_version":"v2.3-50-g53ae\n","edges_bbox":{"minx":3973,"miny":2967,"maxx":4239.5,"maxy":3207},"edges":[{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4047.56,3050.61 4047.56,3026.5 4165.5,3026.5 4165.5,3115.5 4047.56,3115.5 4047.56,3050.61"}],"drawings":{"silkscreen":{"F":[{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4143.5,3110.5 4143.5,3107.5"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4154.5,3110.5 4154.5,3107.5"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4150.5,3106.5 4153.5,3106.5"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4150.5,3111.5 4153.5,3111.5"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4147.5,3106.5 4144.5,3106.5"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4147.5,3111.5 4144.5,3111.5"},{"type":"arc","width":0.5984,"svgpath":"M 4149.125 3108.75 A 0.9505 0.9505 0 0 1 4148.5 3110.5","net":""},{"type":"arc","width":0.5984,"svgpath":"M 4149.1215 3108.75 A 0.9021 0.9021 0 0 1 4149.5 3107","net":""},{"type":"text","svgpath":"M 4081.6899 3125.47 C 4082.2099 3125.47 4082.4499 3125.72 4082.4499 3126.17 C 4082.4499 3126.59 4082.2299 3126.88 4081.6799 3126.88 L 4081.3999 3126.88 L 4081.3999 3126.66 C 4081.3999 3126.26 4081.3999 3125.86 4081.4099 3125.47 Z  M 4081.6299 3127.06 C 4082.5199 3127.06 4082.8599 3126.65 4082.8599 3126.17 C 4082.8599 3125.65 4082.4999 3125.3 4081.7599 3125.3 L 4080.5899 3125.3 L 4080.5899 3125.45 L 4080.9899 3125.49 C 4080.9999 3125.88 4080.9999 3126.27 4080.9999 3126.66 L 4080.9999 3126.87 C 4080.9999 3127.27 4080.9999 3127.65 4080.9899 3128.03 L 4080.5899 3128.08 L 4080.5899 3128.23 L 4081.8299 3128.23 L 4081.8299 3128.08 L 4081.4099 3128.03 C 4081.3999 3127.7 4081.3999 3127.38 4081.3999 3127.06 Z  M 4084.2299 3125.47 C 4084.7499 3125.47 4084.9899 3125.72 4084.9899 3126.17 C 4084.9899 3126.59 4084.7699 3126.88 4084.2199 3126.88 L 4083.9399 3126.88 L 4083.9399 3126.66 C 4083.9399 3126.26 4083.9399 3125.86 4083.9499 3125.47 Z  M 4084.1699 3127.06 C 4085.0599 3127.06 4085.3999 3126.65 4085.3999 3126.17 C 4085.3999 3125.65 4085.0399 3125.3 4084.2999 3125.3 L 4083.1299 3125.3 L 4083.1299 3125.45 L 4083.5299 3125.49 C 4083.5399 3125.88 4083.5399 3126.27 4083.5399 3126.66 L 4083.5399 3126.87 C 4083.5399 3127.27 4083.5399 3127.65 4083.5299 3128.03 L 4083.1299 3128.08 L 4083.1299 3128.23 L 4084.3699 3128.23 L 4084.3699 3128.08 L 4083.9499 3128.03 C 4083.9399 3127.7 4083.9399 3127.38 4083.9399 3127.06 Z  M 4087.7699 3125.49 L 4087.8899 3126.08 L 4088.0999 3126.08 L 4088.0699 3125.3 L 4085.6699 3125.3 L 4085.6299 3126.08 L 4085.8499 3126.08 L 4085.9699 3125.49 L 4086.6599 3125.49 C 4086.6699 3125.87 4086.6699 3126.27 4086.6699 3126.66 L 4086.6699 3126.87 C 4086.6699 3127.27 4086.6699 3127.65 4086.6599 3128.03 L 4086.2099 3128.08 L 4086.2099 3128.23 L 4087.5299 3128.23 L 4087.5299 3128.08 L 4087.0799 3128.03 C 4087.0699 3127.65 4087.0699 3127.26 4087.0699 3126.87 L 4087.0699 3126.66 C 4087.0699 3126.27 4087.0699 3125.87 4087.0799 3125.49 Z  M 4090.4899 3127.44 L 4090.3899 3127.99 C 4090.2199 3128.07 4090.0499 3128.1 4089.8799 3128.1 C 4089.2499 3128.1 4088.8099 3127.64 4088.8099 3126.76 C 4088.8099 3125.89 4089.2899 3125.42 4089.8999 3125.42 C 4090.0499 3125.42 4090.1899 3125.45 4090.3499 3125.53 L 4090.4499 3126.09 L 4090.6899 3126.09 L 4090.6899 3125.45 C 4090.3999 3125.28 4090.0999 3125.23 4089.8499 3125.23 C 4088.9899 3125.23 4088.3599 3125.87 4088.3599 3126.76 C 4088.3599 3127.67 4088.9699 3128.29 4089.8499 3128.29 C 4090.1599 3128.29 4090.4499 3128.23 4090.7299 3128.08 L 4090.7299 3127.44 Z  M 4091.4899 3126.74 C 4091.4899 3125.69 4091.7399 3125.41 4092.0199 3125.41 C 4092.2899 3125.41 4092.5399 3125.69 4092.5399 3126.74 C 4092.5399 3127.83 4092.2899 3128.12 4092.0199 3128.12 C 4091.7399 3128.12 4091.4899 3127.83 4091.4899 3126.74 Z  M 4092.0199 3125.24 C 4091.5499 3125.24 4091.0999 3125.65 4091.0999 3126.74 C 4091.0999 3127.87 4091.5499 3128.29 4092.0199 3128.29 C 4092.4799 3128.29 4092.9299 3127.87 4092.9299 3126.74 C 4092.9299 3125.65 4092.4799 3125.24 4092.0199 3125.24 Z  M 4093.7699 3128.29 C 4093.9399 3128.29 4094.0699 3128.15 4094.0699 3127.99 C 4094.0699 3127.83 4093.9399 3127.69 4093.7699 3127.69 C 4093.6099 3127.69 4093.4699 3127.83 4093.4699 3127.99 C 4093.4699 3128.15 4093.6099 3128.29 4093.7699 3128.29 Z  M 4095.0899 3125.64 L 4096.3599 3125.64 L 4096.3599 3125.3 L 4094.9299 3125.3 L 4094.8299 3126.67 L 4094.9499 3126.7 C 4095.0899 3126.66 4095.2299 3126.64 4095.3699 3126.64 C 4095.7899 3126.64 4096.0499 3126.9 4096.0499 3127.36 C 4096.0499 3127.82 4095.8199 3128.12 4095.3899 3128.12 C 4095.2899 3128.12 4095.2099 3128.11 4095.1099 3128.08 L 4095.0399 3127.81 C 4094.9899 3127.6 4094.9299 3127.54 4094.8099 3127.54 C 4094.7099 3127.54 4094.6299 3127.59 4094.5999 3127.68 C 4094.6899 3128.08 4094.9699 3128.29 4095.4099 3128.29 C 4096.0299 3128.29 4096.4399 3127.9 4096.4399 3127.33 C 4096.4399 3126.74 4096.0499 3126.41 4095.4799 3126.41 C 4095.3199 3126.41 4095.1799 3126.43 4095.0399 3126.47 Z  M 4097.5099 3127.09 L 4097.9599 3125.73 L 4098.4199 3127.09 Z  M 4099.1499 3128.04 L 4098.1999 3125.28 L 4097.9499 3125.28 L 4097.0099 3128.02 L 4096.6599 3128.08 L 4096.6599 3128.23 L 4097.6299 3128.23 L 4097.6299 3128.08 L 4097.2099 3128.02 L 4097.4599 3127.26 L 4098.4699 3127.26 L 4098.7299 3128.03 L 4098.2999 3128.08 L 4098.2999 3128.23 L 4099.4899 3128.23 L 4099.4899 3128.08 Z  M 4099.5499 3128.93 L 4099.7899 3128.93 L 4100.9499 3125.12 L 4100.7199 3125.12 Z  M 4101.4699 3127.89 C 4101.6699 3127.68 4101.8699 3127.48 4101.9799 3127.36 C 4102.6399 3126.67 4102.8599 3126.39 4102.8599 3126.01 C 4102.8599 3125.56 4102.6099 3125.24 4102.0499 3125.24 C 4101.6099 3125.24 4101.2299 3125.46 4101.1699 3125.9 C 4101.2099 3125.98 4101.2899 3126.03 4101.3799 3126.03 C 4101.4899 3126.03 4101.5699 3125.96 4101.6199 3125.76 L 4101.7099 3125.44 C 4101.7999 3125.42 4101.8799 3125.41 4101.9399 3125.41 C 4102.2699 3125.41 4102.4799 3125.66 4102.4799 3126.03 C 4102.4799 3126.39 4102.2799 3126.72 4101.8499 3127.21 C 4101.6599 3127.43 4101.4299 3127.69 4101.1899 3127.96 L 4101.1899 3128.23 L 4102.9899 3128.23 L 4102.9899 3127.89 Z  M 4103.5099 3127.06 L 4104.4699 3125.67 L 4104.4699 3127.06 Z  M 4105.2899 3127.06 L 4104.8299 3127.06 L 4104.8299 3125.25 L 4104.5799 3125.25 L 4103.2899 3127.11 L 4103.2899 3127.32 L 4104.4699 3127.32 L 4104.4699 3128.23 L 4104.8299 3128.23 L 4104.8299 3127.32 L 4105.2899 3127.32 Z  M 4108.2599 3125.3 L 4107.2499 3125.3 L 4107.2499 3125.47 L 4107.6599 3125.51 L 4106.9499 3127.71 L 4106.1799 3125.5 L 4106.6099 3125.47 L 4106.6099 3125.3 L 4105.4199 3125.3 L 4105.4199 3125.45 L 4105.7499 3125.49 L 4106.7699 3128.26 L 4106.9599 3128.26 L 4107.8799 3125.5 L 4108.2599 3125.45 Z  M 4110.4399 3128.14 L 4110.4399 3127.38 L 4112.2599 3127.38 L 4112.2599 3128.14 Z  M 4112.2599 3126.51 L 4112.2599 3127.26 L 4110.4399 3127.26 L 4110.4399 3126.51 Z  M 4112.2599 3125.66 L 4112.2599 3126.4 L 4110.4399 3126.4 L 4110.4399 3125.66 Z  M 4112.3899 3125.35 L 4112.2199 3125.55 L 4111.1299 3125.55 C 4111.2699 3125.39 4111.4199 3125.2 4111.5099 3125.05 C 4111.5999 3125.05 4111.6399 3125.01 4111.6499 3124.96 L 4111.1299 3124.87 C 4111.0999 3125.07 4111.0499 3125.34 4110.9899 3125.55 L 4110.4699 3125.55 L 4110.1099 3125.39 L 4110.1099 3128.55 L 4110.1699 3128.55 C 4110.3099 3128.55 4110.4399 3128.46 4110.4399 3128.42 L 4110.4399 3128.26 L 4112.2599 3128.26 L 4112.2599 3128.54 L 4112.3099 3128.54 C 4112.4299 3128.54 4112.5899 3128.45 4112.5899 3128.42 L 4112.5899 3125.73 C 4112.6799 3125.71 4112.7399 3125.67 4112.7699 3125.64 Z  M 4113.7099 3125.64 C 4113.7299 3125.91 4113.6299 3126.23 4113.5299 3126.36 C 4113.4499 3126.43 4113.4099 3126.53 4113.4799 3126.61 C 4113.5399 3126.7 4113.6999 3126.66 4113.7699 3126.56 C 4113.8699 3126.4 4113.9099 3126.06 4113.7699 3125.64 Z  M 4114.0099 3124.86 L 4114.0099 3128.56 L 4114.0699 3128.56 C 4114.1799 3128.56 4114.3099 3128.49 4114.3099 3128.45 L 4114.3099 3125.03 C 4114.4099 3125.01 4114.4399 3124.97 4114.4499 3124.91 Z  M 4114.3399 3125.61 C 4114.4399 3125.78 4114.5399 3126.04 4114.5399 3126.25 C 4114.7699 3126.48 4115.0599 3125.97 4114.3899 3125.59 Z  M 4117.0899 3125.66 C 4117.1499 3125.66 4117.1899 3125.64 4117.1999 3125.59 C 4117.0599 3125.46 4116.8299 3125.28 4116.8299 3125.28 L 4116.6299 3125.54 L 4115.5199 3125.54 C 4115.5499 3125.38 4115.5699 3125.21 4115.5999 3125.04 C 4115.6899 3125.03 4115.7299 3124.99 4115.7499 3124.95 L 4115.2699 3124.87 C 4115.2599 3125.09 4115.2299 3125.32 4115.1999 3125.54 L 4114.6199 3125.54 L 4114.6499 3125.66 L 4115.1899 3125.66 C 4115.0599 3126.47 4114.8299 3127.19 4114.5099 3127.75 L 4114.5699 3127.79 C 4115.0199 3127.27 4115.3199 3126.54 4115.4899 3125.66 Z  M 4115.5299 3126.34 C 4115.5299 3126.63 4115.3999 3126.95 4115.2899 3127.07 C 4115.2099 3127.15 4115.1699 3127.24 4115.2299 3127.32 C 4115.2899 3127.41 4115.4499 3127.37 4115.5199 3127.26 C 4115.6299 3127.11 4115.7099 3126.77 4115.5999 3126.35 Z  M 4116.6999 3126.29 C 4116.6199 3126.47 4116.4599 3126.81 4116.3199 3127.07 C 4116.2599 3126.88 4116.2299 3126.67 4116.1999 3126.45 C 4116.2099 3126.29 4116.2099 3126.13 4116.2199 3125.96 C 4116.3099 3125.95 4116.3499 3125.9 4116.3499 3125.85 L 4115.8999 3125.81 C 4115.8999 3126.95 4115.9299 3127.84 4114.7799 3128.49 L 4114.8199 3128.55 C 4115.7799 3128.14 4116.0699 3127.57 4116.1599 3126.89 C 4116.2499 3127.62 4116.4499 3128.21 4116.9499 3128.55 C 4116.9799 3128.37 4117.0699 3128.29 4117.2199 3128.27 L 4117.2299 3128.22 C 4116.7699 3127.97 4116.4999 3127.63 4116.3499 3127.18 C 4116.5799 3126.98 4116.8099 3126.74 4116.9399 3126.59 C 4117.0199 3126.61 4117.0699 3126.58 4117.0899 3126.55 Z  M 4118.7499 3127.32 L 4119.9899 3127.32 C 4119.8399 3127.53 4119.6399 3127.71 4119.3999 3127.87 C 4119.1099 3127.74 4118.8699 3127.58 4118.7099 3127.37 Z  M 4118.5899 3126.35 L 4120.0899 3126.35 L 4120.0899 3126.7 L 4118.5899 3126.7 Z  M 4120.0899 3125.9 L 4120.0899 3126.24 L 4118.5899 3126.24 L 4118.5899 3125.9 Z  M 4120.2499 3127.02 L 4120.0199 3127.2 L 4118.8499 3127.2 C 4118.8899 3127.15 4118.9299 3127.1 4118.9699 3127.05 C 4119.0599 3127.06 4119.0899 3127.03 4119.1199 3126.99 L 4118.6999 3126.81 L 4120.0899 3126.81 L 4120.0899 3126.93 L 4120.1499 3126.93 C 4120.2499 3126.93 4120.4099 3126.87 4120.4099 3126.85 L 4120.4099 3125.95 C 4120.4799 3125.93 4120.5399 3125.9 4120.5599 3125.87 L 4120.2199 3125.61 L 4120.0599 3125.78 L 4118.6199 3125.78 L 4118.3199 3125.65 C 4118.3699 3125.59 4118.4299 3125.52 4118.4699 3125.45 L 4120.8299 3125.45 C 4120.8799 3125.45 4120.9199 3125.43 4120.9299 3125.39 C 4120.7799 3125.25 4120.5399 3125.07 4120.5399 3125.07 L 4120.3299 3125.33 L 4118.5499 3125.33 C 4118.5999 3125.26 4118.6399 3125.19 4118.6799 3125.12 C 4118.7699 3125.13 4118.8199 3125.1 4118.8399 3125.06 L 4118.3899 3124.86 C 4118.1899 3125.42 4117.8499 3125.93 4117.5299 3126.24 L 4117.5799 3126.28 C 4117.8299 3126.14 4118.0699 3125.95 4118.2799 3125.7 L 4118.2799 3126.97 L 4118.3299 3126.97 C 4118.4499 3126.97 4118.5899 3126.9 4118.5899 3126.87 L 4118.5899 3126.81 L 4118.6899 3126.81 C 4118.5299 3127.18 4118.1899 3127.65 4117.7899 3127.94 L 4117.8299 3127.99 C 4118.1399 3127.85 4118.4299 3127.65 4118.6499 3127.43 C 4118.7799 3127.65 4118.9599 3127.84 4119.1699 3127.99 C 4118.7299 3128.23 4118.1699 3128.39 4117.5499 3128.49 L 4117.5699 3128.55 C 4118.2799 3128.5 4118.8899 3128.37 4119.3999 3128.13 C 4119.7999 3128.35 4120.2999 3128.47 4120.8799 3128.55 C 4120.9099 3128.39 4120.9999 3128.28 4121.1399 3128.25 L 4121.1399 3128.2 C 4120.6099 3128.17 4120.1199 3128.11 4119.6899 3127.97 C 4119.9599 3127.81 4120.1899 3127.61 4120.3799 3127.38 C 4120.4899 3127.37 4120.5299 3127.36 4120.5599 3127.33 Z  M 4122.2799 3124.87 C 4122.0999 3125.63 4121.7599 3126.4 4121.4199 3126.89 L 4121.4799 3126.93 C 4121.6499 3126.77 4121.8099 3126.58 4121.9599 3126.37 L 4121.9599 3128.55 L 4122.0199 3128.55 C 4122.1299 3128.55 4122.2699 3128.48 4122.2699 3128.45 L 4122.2699 3126.06 C 4122.3499 3126.05 4122.3799 3126.02 4122.3999 3125.99 L 4122.2299 3125.93 C 4122.3799 3125.67 4122.4999 3125.39 4122.6099 3125.1 C 4122.6899 3125.1 4122.7399 3125.07 4122.7599 3125.01 Z  M 4123.1899 3125.24 L 4124.4699 3125.24 L 4124.4699 3126.14 L 4123.1899 3126.14 Z  M 4125.0699 3126.93 C 4125.1299 3126.93 4125.1699 3126.91 4125.1799 3126.87 C 4125.0299 3126.74 4124.7899 3126.55 4124.7899 3126.55 L 4124.5899 3126.82 L 4123.9799 3126.82 L 4123.9799 3126.26 L 4124.4699 3126.26 L 4124.4699 3126.45 L 4124.5199 3126.45 C 4124.6299 3126.45 4124.7899 3126.38 4124.7899 3126.35 L 4124.7899 3125.3 C 4124.8699 3125.29 4124.9299 3125.25 4124.9599 3125.22 L 4124.5999 3124.94 L 4124.4299 3125.13 L 4123.2099 3125.13 L 4122.8699 3124.98 L 4122.8699 3126.51 L 4122.9199 3126.51 C 4123.0499 3126.51 4123.1899 3126.44 4123.1899 3126.41 L 4123.1899 3126.26 L 4123.6599 3126.26 L 4123.6599 3126.82 L 4122.4499 3126.82 L 4122.4799 3126.93 L 4123.4899 3126.93 C 4123.2699 3127.44 4122.8899 3127.93 4122.4099 3128.28 L 4122.4399 3128.33 C 4122.9499 3128.08 4123.3699 3127.74 4123.6599 3127.32 L 4123.6599 3128.56 L 4123.7099 3128.56 C 4123.8699 3128.56 4123.9799 3128.49 4123.9799 3128.46 L 4123.9799 3127.05 C 4124.1999 3127.58 4124.5599 3128.01 4124.9499 3128.29 C 4124.9899 3128.13 4125.0899 3128.03 4125.2199 3128.01 L 4125.2299 3127.97 C 4124.7899 3127.78 4124.2799 3127.39 4124.0099 3126.93 Z  M 4126.5899 3124.93 L 4126.3999 3125.12 L 4125.9899 3125.12 L 4125.6399 3124.97 L 4125.6399 3128.55 L 4125.6899 3128.55 C 4125.8399 3128.55 4125.9399 3128.47 4125.9399 3128.45 L 4125.9399 3125.23 L 4126.4199 3125.23 C 4126.3399 3125.55 4126.2099 3126.03 4126.1299 3126.28 C 4126.3899 3126.57 4126.4899 3126.87 4126.4899 3127.16 C 4126.4899 3127.31 4126.4499 3127.39 4126.3899 3127.43 C 4126.3599 3127.45 4126.3399 3127.45 4126.2899 3127.45 L 4126.0099 3127.45 L 4126.0099 3127.51 C 4126.0999 3127.53 4126.1699 3127.55 4126.2099 3127.59 C 4126.2399 3127.63 4126.2499 3127.73 4126.2499 3127.82 C 4126.6499 3127.81 4126.7899 3127.63 4126.7899 3127.24 C 4126.7899 3126.92 4126.6299 3126.57 4126.2199 3126.27 C 4126.3999 3126.02 4126.6299 3125.56 4126.7499 3125.31 C 4126.8499 3125.31 4126.8999 3125.31 4126.9299 3125.27 Z  M 4128.5499 3128.25 L 4128.1099 3128.25 C 4128.3399 3127.87 4128.5699 3127.35 4128.7399 3126.88 C 4128.8299 3126.88 4128.8699 3126.84 4128.8899 3126.8 L 4128.4199 3126.65 C 4128.3099 3127.18 4128.1499 3127.83 4128.0099 3128.25 L 4126.5199 3128.25 L 4126.5499 3128.36 L 4128.9899 3128.36 C 4129.0399 3128.36 4129.0799 3128.34 4129.0899 3128.3 C 4128.9599 3128.17 4128.7399 3128 4128.7399 3128 Z  M 4127.4899 3126.69 C 4127.5899 3126.99 4127.7099 3127.43 4127.6999 3127.77 C 4127.9699 3128.06 4128.2499 3127.39 4127.5499 3126.67 Z  M 4128.1199 3126.39 L 4127.0099 3126.39 L 4127.0399 3126.51 L 4128.4899 3126.51 C 4128.5499 3126.51 4128.5899 3126.49 4128.5899 3126.45 C 4128.4799 3126.33 4128.2799 3126.19 4128.2799 3126.19 Z  M 4126.8899 3126.76 C 4126.9999 3127.07 4127.1299 3127.51 4127.1199 3127.86 C 4127.3899 3128.15 4127.6699 3127.47 4126.9399 3126.74 Z  M 4127.9099 3125.05 C 4128.0099 3125.04 4128.0599 3125.01 4128.0699 3124.97 L 4127.5899 3124.84 C 4127.4199 3125.33 4127.0199 3125.99 4126.5299 3126.39 L 4126.5699 3126.43 C 4127.1299 3126.13 4127.5699 3125.62 4127.8399 3125.17 C 4128.0499 3125.71 4128.4299 3126.2 4128.8899 3126.48 C 4128.9199 3126.37 4129.0099 3126.29 4129.1399 3126.25 L 4129.1499 3126.2 C 4128.6599 3125.99 4128.1199 3125.57 4127.8999 3125.06 Z  M 4131.3999 3126.72 C 4131.4299 3126.7 4131.4699 3126.67 4131.4899 3126.61 C 4131.7399 3126.56 4131.9799 3126.49 4132.1599 3126.43 C 4131.9099 3126.79 4131.6199 3127.14 4131.3899 3127.33 C 4131.3499 3127.36 4131.2599 3127.38 4131.2599 3127.38 L 4131.4499 3127.78 C 4131.4799 3127.77 4131.5099 3127.74 4131.5299 3127.7 C 4132.1499 3127.59 4132.6899 3127.46 4133.0099 3127.39 L 4133.0099 3127.32 C 4132.4499 3127.35 4131.8899 3127.37 4131.5599 3127.38 C 4132.0499 3126.99 4132.5999 3126.39 4132.8799 3125.99 C 4132.9599 3126 4133.0099 3125.97 4133.0299 3125.93 L 4132.5999 3125.68 C 4132.5299 3125.85 4132.3899 3126.08 4132.2399 3126.31 C 4131.9599 3126.32 4131.6799 3126.32 4131.4799 3126.32 C 4131.8199 3126.01 4132.1899 3125.53 4132.3899 3125.19 C 4132.4699 3125.2 4132.5199 3125.17 4132.5399 3125.13 L 4132.0799 3124.92 C 4131.9499 3125.3 4131.5899 3125.99 4131.3299 3126.27 C 4131.2899 3126.3 4131.2099 3126.32 4131.2099 3126.32 Z  M 4129.7499 3127.84 C 4129.7899 3127.82 4129.8199 3127.79 4129.8499 3127.75 C 4130.3799 3127.61 4130.8499 3127.48 4131.1199 3127.4 L 4131.1199 3127.34 C 4130.6399 3127.37 4130.1799 3127.41 4129.8699 3127.42 C 4130.3899 3126.99 4130.9599 3126.34 4131.2399 3125.9 C 4131.3199 3125.92 4131.3699 3125.89 4131.3999 3125.85 L 4130.9699 3125.59 C 4130.8899 3125.78 4130.7499 3126.03 4130.5799 3126.28 C 4130.3099 3126.29 4130.0299 3126.3 4129.8299 3126.3 C 4130.1599 3125.99 4130.5299 3125.51 4130.7299 3125.16 C 4130.8099 3125.17 4130.8599 3125.14 4130.8799 3125.1 L 4130.4099 3124.89 C 4130.2899 3125.27 4129.9399 3125.97 4129.6699 3126.25 C 4129.6499 3126.27 4129.5599 3126.29 4129.5599 3126.29 L 4129.7499 3126.69 C 4129.7899 3126.68 4129.8199 3126.64 4129.8499 3126.58 C 4130.0999 3126.53 4130.3299 3126.45 4130.5099 3126.4 C 4130.2499 3126.79 4129.9499 3127.17 4129.6999 3127.38 C 4129.6699 3127.41 4129.5699 3127.43 4129.5699 3127.43 Z  M 4132.4799 3128.2 L 4129.4999 3128.2 L 4129.5299 3128.31 L 4133.0699 3128.31 C 4133.1299 3128.31 4133.1699 3128.29 4133.1799 3128.25 C 4133.0099 3128.1 4132.7299 3127.9 4132.7299 3127.9 Z  M 4133.4999 3127.26 L 4134.5199 3127.26 L 4134.5199 3127 L 4133.4999 3127 Z  M 4135.2699 3126.74 C 4135.2699 3125.69 4135.5199 3125.41 4135.7999 3125.41 C 4136.0699 3125.41 4136.3199 3125.69 4136.3199 3126.74 C 4136.3199 3127.83 4136.0699 3128.12 4135.7999 3128.12 C 4135.5199 3128.12 4135.2699 3127.83 4135.2699 3126.74 Z  M 4135.7999 3125.24 C 4135.3299 3125.24 4134.8799 3125.65 4134.8799 3126.74 C 4134.8799 3127.87 4135.3299 3128.29 4135.7999 3128.29 C 4136.2599 3128.29 4136.7099 3127.87 4136.7099 3126.74 C 4136.7099 3125.65 4136.2599 3125.24 4135.7999 3125.24 Z  M 4137.4499 3126.89 C 4137.6299 3126.73 4137.8299 3126.67 4138.0199 3126.67 C 4138.3299 3126.67 4138.5399 3126.89 4138.5399 3127.38 C 4138.5399 3127.87 4138.3299 3128.12 4138.0299 3128.12 C 4137.6699 3128.12 4137.4499 3127.73 4137.4499 3126.97 Z  M 4138.7599 3125.24 C 4137.6699 3125.37 4137.0699 3126.13 4137.0699 3127.03 C 4137.0699 3127.82 4137.4299 3128.29 4138.0199 3128.29 C 4138.5499 3128.29 4138.9099 3127.93 4138.9099 3127.32 C 4138.9099 3126.78 4138.5899 3126.44 4138.1199 3126.44 C 4137.8799 3126.44 4137.6499 3126.54 4137.4699 3126.73 C 4137.5399 3126.01 4137.9499 3125.55 4138.7799 3125.35 Z  M 4139.6599 3126.74 C 4139.6599 3125.69 4139.9099 3125.41 4140.1899 3125.41 C 4140.4599 3125.41 4140.7099 3125.69 4140.7099 3126.74 C 4140.7099 3127.83 4140.4599 3128.12 4140.1899 3128.12 C 4139.9099 3128.12 4139.6599 3127.83 4139.6599 3126.74 Z  M 4140.1899 3125.24 C 4139.7199 3125.24 4139.2699 3125.65 4139.2699 3126.74 C 4139.2699 3127.87 4139.7199 3128.29 4140.1899 3128.29 C 4140.6499 3128.29 4141.1099 3127.87 4141.1099 3126.74 C 4141.1099 3125.65 4140.6499 3125.24 4140.1899 3125.24 Z  M 4142.0799 3125.43 C 4142.1599 3125.41 4142.2299 3125.41 4142.2899 3125.41 C 4142.6399 3125.41 4142.8399 3125.61 4142.8399 3125.97 C 4142.8399 3126.37 4142.5899 3126.59 4142.1999 3126.59 L 4142.0299 3126.59 L 4142.0299 3126.78 L 4142.2299 3126.78 C 4142.6899 3126.78 4142.9099 3127.04 4142.9099 3127.45 C 4142.9099 3127.84 4142.6699 3128.12 4142.2499 3128.12 C 4142.1699 3128.12 4142.0899 3128.11 4141.9999 3128.09 L 4141.9299 3127.83 C 4141.8799 3127.63 4141.8299 3127.54 4141.6899 3127.54 C 4141.5999 3127.54 4141.5299 3127.58 4141.4799 3127.68 C 4141.5599 3128.1 4141.8799 3128.29 4142.3199 3128.29 C 4142.8999 3128.29 4143.2999 3127.93 4143.2999 3127.45 C 4143.2999 3127.06 4143.0699 3126.77 4142.5899 3126.68 C 4142.9899 3126.56 4143.2099 3126.29 4143.2099 3125.95 C 4143.2099 3125.53 4142.8899 3125.24 4142.3799 3125.24 C 4141.9699 3125.24 4141.6399 3125.42 4141.5599 3125.8 C 4141.5999 3125.91 4141.6699 3125.95 4141.7599 3125.95 C 4141.8999 3125.95 4141.9599 3125.87 4142.0099 3125.69 Z ","useTrueTypeFontRendering":true,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4141.5 3111.04 L 4141.5 3106.75 M 4141.5 3111.04 L 4138.84 3111.04 M 4141.5 3109 L 4139.86 3109 M 4137.49 3111.04 L 4137.49 3107.97 L 4137.29 3107.36 L 4136.88 3106.95 L 4136.26 3106.75 L 4135.85 3106.75 L 4135.24 3106.95 L 4134.83 3107.36 L 4134.63 3107.97 L 4134.63 3111.04 M 4130.41 3110.43 L 4130.82 3110.84 L 4131.44 3111.04 L 4132.25 3111.04 L 4132.87 3110.84 L 4133.28 3110.43 L 4133.28 3110.02 L 4133.07 3109.61 L 4132.87 3109.4 L 4132.46 3109.2 L 4131.23 3108.79 L 4130.82 3108.59 L 4130.62 3108.38 L 4130.41 3107.97 L 4130.41 3107.36 L 4130.82 3106.95 L 4131.44 3106.75 L 4132.25 3106.75 L 4132.87 3106.95 L 4133.28 3107.36 M 4129.06 3111.04 L 4129.06 3106.75 M 4129.06 3111.04 L 4126.4 3111.04 M 4129.06 3109 L 4127.43 3109 M 4129.06 3106.75 L 4126.4 3106.75 M 4125.05 3110.22 L 4124.65 3110.43 L 4124.03 3111.04 L 4124.03 3106.75","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4057.7737,3107.6322 4057.7737,3107.6714 4056.4743,3108.9708"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4055.0964,3107.6322 4055.1357,3107.6322 4056.4743,3108.9708"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4055.0964,3107.6322 4057.7737,3107.6322"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4053.5213,3107.5533 4053.5213,3103.0257"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4059.4273,3107.5533 4059.4273,3103.0257"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4053.5217,3103.0257 4059.3482,3103.0257"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4059.4364,3109.0494 4059.4364,3113.1837"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4057.8613,3114.3646 4058.2551,3114.3646 4059.4364,3113.1837"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4055.1056,3114.3646 4057.8613,3114.3646"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4055.1056,3114.3646 4054.7113,3114.3646 4053.5304,3113.1837"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4053.5304,3109.0494 4053.5304,3113.1837"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5906,"svgpath":"M4056.4743,3107.6322 4056.4743,3108.9708"},{"type":"text","svgpath":"M 4040.2375 3109.1125 L 4044.5275 3109.1125 M 4044.5275 3109.1125 L 4044.5275 3106.6625 M 4040.2375 3105.3125 L 4044.5275 3105.3125 M 4040.2375 3105.3125 L 4040.2375 3102.6525 M 4042.2775 3105.3125 L 4042.2775 3103.6725 M 4044.5275 3105.3125 L 4044.5275 3102.6525 M 4040.2375 3101.3025 L 4044.5275 3101.3025 M 4040.2375 3101.3025 L 4040.2375 3099.8625 L 4040.4375 3099.2525 L 4040.8475 3098.8425 L 4041.2575 3098.6425 L 4041.8775 3098.4325 L 4042.8975 3098.4325 L 4043.5075 3098.6425 L 4043.9175 3098.8425 L 4044.3275 3099.2525 L 4044.5275 3099.8625 L 4044.5275 3101.3025 M 4040.2375 3095.8625 L 4040.4375 3096.4725 L 4041.0575 3096.8825 L 4042.0775 3097.0825 L 4042.6875 3097.0825 L 4043.7175 3096.8825 L 4044.3275 3096.4725 L 4044.5275 3095.8625 L 4044.5275 3095.4525 L 4044.3275 3094.8325 L 4043.7175 3094.4225 L 4042.6875 3094.2225 L 4042.0775 3094.2225 L 4041.0575 3094.4225 L 4040.4375 3094.8325 L 4040.2375 3095.4525 L 4040.2375 3095.8625 M 4040.8475 3090.4125 L 4040.4375 3090.6225 L 4040.2375 3091.2325 L 4040.2375 3091.6425 L 4040.4375 3092.2625 L 4041.0575 3092.6625 L 4042.0775 3092.8725 L 4043.0975 3092.8725 L 4043.9175 3092.6625 L 4044.3275 3092.2625 L 4044.5275 3091.6425 L 4044.5275 3091.4425 L 4044.3275 3090.8225 L 4043.9175 3090.4125 L 4043.3075 3090.2125 L 4043.0975 3090.2125 L 4042.4875 3090.4125 L 4042.0775 3090.8225 L 4041.8775 3091.4425 L 4041.8775 3091.6425 L 4042.0775 3092.2625 L 4042.4875 3092.6625 L 4043.0975 3092.8725 M 4040.2375 3087.6325 L 4040.4375 3088.2525 L 4041.0575 3088.6625 L 4042.0775 3088.8625 L 4042.6875 3088.8625 L 4043.7175 3088.6625 L 4044.3275 3088.2525 L 4044.5275 3087.6325 L 4044.5275 3087.2225 L 4044.3275 3086.6125 L 4043.7175 3086.2025 L 4042.6875 3086.0025 L 4042.0775 3086.0025 L 4041.0575 3086.2025 L 4040.4375 3086.6125 L 4040.2375 3087.2225 L 4040.2375 3087.6325 M 4040.2375 3084.2425 L 4040.2375 3081.9925 L 4041.8775 3083.2125 L 4041.8775 3082.6025 L 4042.0775 3082.1925 L 4042.2775 3081.9925 L 4042.8975 3081.7825 L 4043.3075 3081.7825 L 4043.9175 3081.9925 L 4044.3275 3082.4025 L 4044.5275 3083.0125 L 4044.5275 3083.6225 L 4044.3275 3084.2425 L 4044.1275 3084.4425 L 4043.7175 3084.6525","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4053.96 3117.5 L 4058.25 3117.5 M 4058.25 3117.5 L 4058.25 3115.05 M 4053.96 3113.7 L 4058.25 3113.7 M 4053.96 3113.7 L 4053.96 3111.04 M 4056 3113.7 L 4056 3112.06 M 4058.25 3113.7 L 4058.25 3111.04 M 4053.96 3109.69 L 4058.25 3109.69 M 4053.96 3109.69 L 4053.96 3108.25 L 4054.16 3107.64 L 4054.57 3107.23 L 4054.98 3107.03 L 4055.6 3106.82 L 4056.62 3106.82 L 4057.23 3107.03 L 4057.64 3107.23 L 4058.05 3107.64 L 4058.25 3108.25 L 4058.25 3109.69 M 4054.78 3105.47 L 4054.57 3105.06 L 4053.96 3104.45 L 4058.25 3104.45","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4161.3591,3100.9518 4160.5472,3100.9518"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.5984,"svgpath":"M4155.6409,3100.9518 4156.4134,3100.9518"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4155.6409,3107.8512 4155.6409,3100.9518"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4161.3591,3107.8512 4161.3591,3100.9518"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4155.6409,3106.2589 4161.3591,3106.2589"},{"type":"polygon","svgpath":"M 4155.3409 3107.5511 L 4156.7283 3107.5511 L 4156.7283 3108.7511 L 4155.3409 3108.7511 Z ","start":[0,0],"end":[0,0],"net":""},{"type":"polygon","svgpath":"M 4161.6591 3107.5511 L 4160.2717 3107.5511 L 4160.2717 3108.7511 L 4161.6591 3108.7511 Z ","start":[0,0],"end":[0,0],"net":""},{"type":"text","svgpath":"M 4142.78 3105.4015 L 4142.57 3104.9915 L 4141.96 3104.3715 L 4146.25 3104.3715 M 4141.96 3103.0215 L 4146.25 3103.0215 M 4141.96 3103.0215 L 4146.25 3100.1615 M 4141.96 3100.1615 L 4146.25 3100.1615 M 4141.96 3096.3615 L 4141.96 3098.4015 L 4143.8 3098.6115 L 4143.6 3098.4015 L 4143.39 3097.7915 L 4143.39 3097.1715 L 4143.6 3096.5615 L 4144 3096.1515 L 4144.62 3095.9515 L 4145.03 3095.9515 L 4145.64 3096.1515 L 4146.05 3096.5615 L 4146.25 3097.1715 L 4146.25 3097.7915 L 4146.05 3098.4015 L 4145.85 3098.6115 L 4145.44 3098.8115 M 4141.96 3093.5715 L 4142.16 3094.1915 L 4142.57 3094.3915 L 4142.98 3094.3915 L 4143.39 3094.1915 L 4143.6 3093.7815 L 4143.8 3092.9615 L 4144 3092.3515 L 4144.41 3091.9415 L 4144.82 3091.7315 L 4145.44 3091.7315 L 4145.85 3091.9415 L 4146.05 3092.1415 L 4146.25 3092.7615 L 4146.25 3093.5715 L 4146.05 3094.1915 L 4145.85 3094.3915 L 4145.44 3094.6015 L 4144.82 3094.6015 L 4144.41 3094.3915 L 4144 3093.9815 L 4143.8 3093.3715 L 4143.6 3092.5515 L 4143.39 3092.1415 L 4142.98 3091.9415 L 4142.57 3091.9415 L 4142.16 3092.1415 L 4141.96 3092.7615 L 4141.96 3093.5715 M 4142.78 3090.3815 L 4142.57 3089.9715 L 4141.96 3089.3615 L 4146.25 3089.3615 M 4143.39 3085.3515 L 4144 3085.5615 L 4144.41 3085.9715 L 4144.62 3086.5815 L 4144.62 3086.7815 L 4144.41 3087.4015 L 4144 3087.8115 L 4143.39 3088.0115 L 4143.19 3088.0115 L 4142.57 3087.8115 L 4142.16 3087.4015 L 4141.96 3086.7815 L 4141.96 3086.5815 L 4142.16 3085.9715 L 4142.57 3085.5615 L 4143.39 3085.3515 L 4144.41 3085.3515 L 4145.44 3085.5615 L 4146.05 3085.9715 L 4146.25 3086.5815 L 4146.25 3086.9915 L 4146.05 3087.6015 L 4145.64 3087.8115 M 4141.96 3084.0015 L 4146.25 3082.9815 M 4141.96 3081.9615 L 4146.25 3082.9815 M 4141.96 3081.9615 L 4146.25 3080.9315 M 4141.96 3079.9115 L 4146.25 3080.9315 M 4142.57 3075.7015 L 4142.16 3076.1115 L 4141.96 3076.7215 L 4141.96 3077.5415 L 4142.16 3078.1515 L 4142.57 3078.5615 L 4142.98 3078.5615 L 4143.39 3078.3615 L 4143.6 3078.1515 L 4143.8 3077.7415 L 4144.21 3076.5215 L 4144.41 3076.1115 L 4144.62 3075.9015 L 4145.03 3075.7015 L 4145.64 3075.7015 L 4146.05 3076.1115 L 4146.25 3076.7215 L 4146.25 3077.5415 L 4146.05 3078.1515 L 4145.64 3078.5615","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4157.46 3110.0031 L 4161.75 3110.0031 M 4157.46 3110.0031 L 4157.46 3108.5731 L 4157.66 3107.9531 L 4158.07 3107.5431 L 4158.48 3107.3431 L 4159.1 3107.1331 L 4160.12 3107.1331 L 4160.73 3107.3431 L 4161.14 3107.5431 L 4161.55 3107.9531 L 4161.75 3108.5731 L 4161.75 3110.0031 M 4158.28 3105.7831 L 4158.07 3105.3731 L 4157.46 3104.7631 L 4161.75 3104.7631","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4066.1008,3106.822 4066.1008,3103.0469 4060.8992,3103.0469 4060.8992,3106.822"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4066.1008,3110.178 4066.1008,3113.9531 4060.8992,3113.9531 4060.8992,3110.178"},{"type":"text","svgpath":"M 4048.98 3108.2898 L 4048.78 3108.2898 L 4048.37 3108.0898 L 4048.16 3107.8798 L 4047.96 3107.4698 L 4047.96 3106.6598 L 4048.16 3106.2498 L 4048.37 3106.0398 L 4048.78 3105.8398 L 4049.19 3105.8398 L 4049.6 3106.0398 L 4050.21 3106.4498 L 4052.25 3108.4998 L 4052.25 3105.6298 M 4047.96 3103.0598 L 4048.16 3103.6698 L 4048.78 3104.0798 L 4049.8 3104.2798 L 4050.41 3104.2798 L 4051.44 3104.0798 L 4052.05 3103.6698 L 4052.25 3103.0598 L 4052.25 3102.6498 L 4052.05 3102.0298 L 4051.44 3101.6198 L 4050.41 3101.4198 L 4049.8 3101.4198 L 4048.78 3101.6198 L 4048.16 3102.0298 L 4047.96 3102.6498 L 4047.96 3103.0598 M 4047.96 3100.0698 L 4052.25 3100.0698 M 4049.39 3098.0198 L 4051.44 3100.0698 M 4050.62 3099.2498 L 4052.25 3097.8198","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4061.46 3113.5031 L 4065.75 3113.5031 M 4061.46 3113.5031 L 4061.46 3111.6631 L 4061.66 3111.0431 L 4061.87 3110.8431 L 4062.28 3110.6331 L 4062.69 3110.6331 L 4063.1 3110.8431 L 4063.3 3111.0431 L 4063.5 3111.6631 L 4063.5 3113.5031 M 4063.5 3112.0731 L 4065.75 3110.6331 M 4062.28 3109.2831 L 4062.07 3108.8731 L 4061.46 3108.2631 L 4065.75 3108.2631","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4026.423,3112.32 4024.9779,3112.32 4024.9779,3108.32"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4024.9779,3034.32 4024.9779,3030.32 4026.423,3030.32"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4001.9779,3103.82 4001.9779,3038.82"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4022.4779,3105.82 4003.9779,3105.82"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4022.4779,3036.82 4003.9779,3036.82"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4006.9779,3082.32 4015.9779,3082.32 4015.9779,3091.32 4006.9779,3091.32"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4006.9779,3066.82 4015.9779,3066.82 4015.9779,3075.82 4006.9779,3075.82"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4006.9779,3051.32 4015.9779,3051.32 4015.9779,3060.32 4006.9779,3060.32"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4037.923,3030.82 4028.423,3030.82 4028.423,3030.32 4026.423,3030.32"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4040.423,3109.395 4040.423,3033.245"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4037.923,3111.82 4028.423,3111.82 4028.423,3112.32 4026.423,3112.32"},{"type":"arc","width":0.6,"svgpath":"M 4037.923 3111.82 A 2.5 2.5 0 0 0 4040.423 3109.32","net":""},{"type":"arc","width":0.6,"svgpath":"M 4040.423 3033.32 A 2.5 2.5 0 0 0 4037.923 3030.82","net":""},{"type":"arc","width":0.6,"svgpath":"M 4003.978 3105.82 A 2 2 0 0 1 4001.978 3103.82","net":""},{"type":"arc","width":0.6,"svgpath":"M 4001.978 3038.82 A 2 2 0 0 1 4003.978 3036.82","net":""},{"type":"arc","width":0.6,"svgpath":"M 4022.478 3036.82 A 2.5 2.5 0 0 0 4024.978 3034.32","net":""},{"type":"arc","width":0.6,"svgpath":"M 4024.978 3108.32 A 2.5 2.5 0 0 0 4022.478 3105.82","net":""},{"type":"polygon","svgpath":"M 4046.801 3107.54 L 4046.801 3035.1 L 4040.502 3035.1 L 4040.502 3107.54 Z","start":[0,0],"end":[0,0],"net":""},{"type":"text","svgpath":"M 3988.96 3071.5002 L 3993.25 3071.5002 M 3988.96 3071.5002 L 3988.96 3070.0702 L 3989.16 3069.4502 L 3989.57 3069.0502 L 3989.98 3068.8402 L 3990.6 3068.6402 L 3991.62 3068.6402 L 3992.23 3068.8402 L 3992.64 3069.0502 L 3993.05 3069.4502 L 3993.25 3070.0702 L 3993.25 3071.5002 M 3988.96 3067.2902 L 3993.25 3067.2902 M 3988.96 3067.2902 L 3988.96 3065.4502 L 3989.16 3064.8302 L 3989.37 3064.6302 L 3989.78 3064.4202 L 3990.19 3064.4202 L 3990.6 3064.6302 L 3990.8 3064.8302 L 3991 3065.4502 M 3991 3067.2902 L 3991 3065.4502 L 3991.21 3064.8302 L 3991.41 3064.6302 L 3991.82 3064.4202 L 3992.44 3064.4202 L 3992.85 3064.6302 L 3993.05 3064.8302 L 3993.25 3065.4502 L 3993.25 3067.2902 M 3990.39 3060.4102 L 3991 3060.6202 L 3991.41 3061.0302 L 3991.62 3061.6402 L 3991.62 3061.8502 L 3991.41 3062.4602 L 3991 3062.8702 L 3990.39 3063.0702 L 3990.19 3063.0702 L 3989.57 3062.8702 L 3989.16 3062.4602 L 3988.96 3061.8502 L 3988.96 3061.6402 L 3989.16 3061.0302 L 3989.57 3060.6202 L 3990.39 3060.4102 L 3991.41 3060.4102 L 3992.44 3060.6202 L 3993.05 3061.0302 L 3993.25 3061.6402 L 3993.25 3062.0502 L 3993.05 3062.6602 L 3992.64 3062.8702 M 3991.41 3059.0602 L 3991.41 3055.3802 M 3988.96 3054.0302 L 3993.25 3054.0302 M 3988.96 3054.0302 L 3988.96 3051.3702 M 3991 3054.0302 L 3991 3052.4002 M 3988.96 3050.0202 L 3993.25 3050.0202 M 3988.96 3050.0202 L 3988.96 3047.3602 M 3991 3050.0202 L 3991 3048.3902 M 3993.25 3050.0202 L 3993.25 3047.3602 M 3988.96 3046.0102 L 3993.25 3046.0102 M 3988.96 3046.0102 L 3993.25 3044.3802 M 3988.96 3042.7402 L 3993.25 3044.3802 M 3988.96 3042.7402 L 3993.25 3042.7402 M 3988.96 3039.7502 L 3993.25 3041.3902 M 3988.96 3039.7502 L 3993.25 3038.1202 M 3991.82 3040.7802 L 3991.82 3038.7302 M 3988.96 3036.7702 L 3993.25 3036.7702 M 3993.25 3036.7702 L 3993.25 3034.3102 M 3988.96 3032.9602 L 3993.25 3032.9602 M 3988.96 3032.9602 L 3988.96 3030.3002 M 3991 3032.9602 L 3991 3031.3302 M 3993.25 3032.9602 L 3993.25 3030.3002 M 3991.41 3028.9502 L 3991.41 3025.2702 M 3988.96 3023.9202 L 3993.25 3023.9202 M 3988.96 3023.9202 L 3993.25 3022.2902 M 3988.96 3020.6502 L 3993.25 3022.2902 M 3988.96 3020.6502 L 3993.25 3020.6502 M 3989.57 3016.4402 L 3989.16 3016.8502 L 3988.96 3017.4602 L 3988.96 3018.2802 L 3989.16 3018.8902 L 3989.57 3019.3002 L 3989.98 3019.3002 L 3990.39 3019.1002 L 3990.6 3018.8902 L 3990.8 3018.4802 L 3991.21 3017.2502 L 3991.41 3016.8502 L 3991.62 3016.6402 L 3992.03 3016.4402 L 3992.64 3016.4402 L 3993.05 3016.8502 L 3993.25 3017.4602 L 3993.25 3018.2802 L 3993.05 3018.8902 L 3992.64 3019.3002 M 3988.96 3015.0902 L 3993.25 3012.2202 M 3988.96 3012.2202 L 3993.25 3015.0902","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 3995.96 3071.5 L 4000.25 3071.5 M 3995.96 3071.5 L 3995.96 3069.66 L 3996.16 3069.05 L 3996.37 3068.84 L 3996.78 3068.64 L 3997.39 3068.64 L 3997.8 3068.84 L 3998 3069.05 L 3998.21 3069.66 L 3998.21 3071.5 M 3996.78 3067.29 L 3996.57 3066.88 L 3995.96 3066.26 L 4000.25 3066.26","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"text","svgpath":"M 4064.363 3093.997 L 4064.133 3093.547 L 4063.453 3092.867 L 4068.223 3092.867","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"text","svgpath":"M 4063.45 3048.277 L 4063.45 3050.547 L 4065.5 3050.777 L 4065.27 3050.547 L 4065.05 3049.867 L 4065.05 3049.177 L 4065.27 3048.497 L 4065.73 3048.047 L 4066.41 3047.817 L 4066.86 3047.817 L 4067.55 3048.047 L 4068 3048.497 L 4068.23 3049.177 L 4068.23 3049.867 L 4068 3050.547 L 4067.77 3050.777 L 4067.32 3050.997","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4185.577,3030.18 4187.0221,3030.18 4187.0221,3034.18"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4187.0221,3108.18 4187.0221,3112.18 4185.577,3112.18"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4210.0221,3038.68 4210.0221,3103.68"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4189.5221,3036.68 4208.0221,3036.68"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4189.5221,3105.68 4208.0221,3105.68"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4205.0221,3060.18 4196.0221,3060.18 4196.0221,3051.18 4205.0221,3051.18"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4205.0221,3075.68 4196.0221,3075.68 4196.0221,3066.68 4205.0221,3066.68"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4205.0221,3091.18 4196.0221,3091.18 4196.0221,3082.18 4205.0221,3082.18"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4174.077,3111.68 4183.577,3111.68 4183.577,3112.18 4185.577,3112.18"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4171.577,3033.105 4171.577,3109.255"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":0.6,"svgpath":"M4174.077,3030.68 4183.577,3030.68 4183.577,3030.18 4185.577,3030.18"},{"type":"arc","width":0.6,"svgpath":"M 4174.077 3030.68 A 2.5 2.5 0 0 0 4171.577 3033.18","net":""},{"type":"arc","width":0.6,"svgpath":"M 4171.577 3109.18 A 2.5 2.5 0 0 0 4174.077 3111.68","net":""},{"type":"arc","width":0.6,"svgpath":"M 4208.022 3036.68 A 2 2 0 0 1 4210.022 3038.68","net":""},{"type":"arc","width":0.6,"svgpath":"M 4210.022 3103.68 A 2 2 0 0 1 4208.022 3105.68","net":""},{"type":"arc","width":0.6,"svgpath":"M 4189.522 3105.68 A 2.5 2.5 0 0 0 4187.022 3108.18","net":""},{"type":"arc","width":0.6,"svgpath":"M 4187.022 3034.18 A 2.5 2.5 0 0 0 4189.522 3036.68","net":""},{"type":"polygon","svgpath":"M 4165.199 3034.96 L 4165.199 3107.4 L 4171.498 3107.4 L 4171.498 3034.96 Z","start":[0,0],"end":[0,0],"net":""},{"type":"text","svgpath":"M 4218.75 3130.28 L 4223.04 3130.28 M 4218.75 3130.28 L 4218.75 3128.85 L 4218.95 3128.23 L 4219.36 3127.83 L 4219.77 3127.62 L 4220.39 3127.42 L 4221.41 3127.42 L 4222.02 3127.62 L 4222.43 3127.83 L 4222.84 3128.23 L 4223.04 3128.85 L 4223.04 3130.28 M 4218.75 3126.07 L 4223.04 3126.07 M 4218.75 3126.07 L 4218.75 3124.23 L 4218.95 3123.61 L 4219.16 3123.41 L 4219.57 3123.2 L 4219.98 3123.2 L 4220.39 3123.41 L 4220.59 3123.61 L 4220.79 3124.23 M 4220.79 3126.07 L 4220.79 3124.23 L 4221 3123.61 L 4221.2 3123.41 L 4221.61 3123.2 L 4222.23 3123.2 L 4222.64 3123.41 L 4222.84 3123.61 L 4223.04 3124.23 L 4223.04 3126.07 M 4220.18 3119.19 L 4220.79 3119.4 L 4221.2 3119.81 L 4221.41 3120.42 L 4221.41 3120.63 L 4221.2 3121.24 L 4220.79 3121.65 L 4220.18 3121.85 L 4219.98 3121.85 L 4219.36 3121.65 L 4218.95 3121.24 L 4218.75 3120.63 L 4218.75 3120.42 L 4218.95 3119.81 L 4219.36 3119.4 L 4220.18 3119.19 L 4221.2 3119.19 L 4222.23 3119.4 L 4222.84 3119.81 L 4223.04 3120.42 L 4223.04 3120.83 L 4222.84 3121.44 L 4222.43 3121.65 M 4221.2 3117.84 L 4221.2 3114.16 M 4218.75 3112.81 L 4223.04 3112.81 M 4218.75 3112.81 L 4218.75 3110.15 M 4220.79 3112.81 L 4220.79 3111.18 M 4218.75 3108.8 L 4223.04 3108.8 M 4218.75 3108.8 L 4218.75 3106.14 M 4220.79 3108.8 L 4220.79 3107.17 M 4223.04 3108.8 L 4223.04 3106.14 M 4218.75 3104.79 L 4223.04 3104.79 M 4218.75 3104.79 L 4223.04 3103.16 M 4218.75 3101.52 L 4223.04 3103.16 M 4218.75 3101.52 L 4223.04 3101.52 M 4218.75 3098.53 L 4223.04 3100.17 M 4218.75 3098.53 L 4223.04 3096.9 M 4221.61 3099.56 L 4221.61 3097.51 M 4218.75 3095.55 L 4223.04 3095.55 M 4223.04 3095.55 L 4223.04 3093.09 M 4218.75 3091.74 L 4223.04 3091.74 M 4218.75 3091.74 L 4218.75 3089.08 M 4220.79 3091.74 L 4220.79 3090.11 M 4223.04 3091.74 L 4223.04 3089.08 M 4221.2 3087.73 L 4221.2 3084.05 M 4218.75 3082.7 L 4223.04 3082.7 M 4218.75 3082.7 L 4223.04 3081.07 M 4218.75 3079.43 L 4223.04 3081.07 M 4218.75 3079.43 L 4223.04 3079.43 M 4219.36 3075.22 L 4218.95 3075.63 L 4218.75 3076.24 L 4218.75 3077.06 L 4218.95 3077.67 L 4219.36 3078.08 L 4219.77 3078.08 L 4220.18 3077.88 L 4220.39 3077.67 L 4220.59 3077.26 L 4221 3076.03 L 4221.2 3075.63 L 4221.41 3075.42 L 4221.82 3075.22 L 4222.43 3075.22 L 4222.84 3075.63 L 4223.04 3076.24 L 4223.04 3077.06 L 4222.84 3077.67 L 4222.43 3078.08 M 4218.75 3073.87 L 4223.04 3071 M 4218.75 3071 L 4223.04 3073.87","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4216.04 3071 L 4211.75 3071 M 4216.04 3071 L 4216.04 3072.84 L 4215.84 3073.45 L 4215.63 3073.66 L 4215.22 3073.86 L 4214.61 3073.86 L 4214.2 3073.66 L 4214 3073.45 L 4213.79 3072.84 L 4213.79 3071 M 4215.02 3075.42 L 4215.22 3075.42 L 4215.63 3075.62 L 4215.84 3075.83 L 4216.04 3076.24 L 4216.04 3077.05 L 4215.84 3077.46 L 4215.63 3077.67 L 4215.22 3077.87 L 4214.81 3077.87 L 4214.4 3077.67 L 4213.79 3077.26 L 4211.75 3075.21 L 4211.75 3078.08","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"text","svgpath":"M 4147.637 3048.503 L 4147.867 3048.953 L 4148.547 3049.633 L 4143.777 3049.633","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"text","svgpath":"M 4148.55 3094.223 L 4148.55 3091.953 L 4146.5 3091.723 L 4146.73 3091.953 L 4146.95 3092.633 L 4146.95 3093.323 L 4146.73 3094.003 L 4146.27 3094.453 L 4145.59 3094.683 L 4145.14 3094.683 L 4144.45 3094.453 L 4144 3094.003 L 4143.77 3093.323 L 4143.77 3092.633 L 4144 3091.953 L 4144.23 3091.723 L 4144.68 3091.503","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4141.4351,3124.7383 4141.4351,3124.2283 4141.4351,3159.2283 4070.5651,3159.2283 4070.5651,3024.3483 4141.4351,3024.3483 4141.4351,3124.1883 4141.4351,3124.2283 4141.4351,3124.7383"},{"type":"polyline","net":"","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4116.2652,3160.1732 4116.2652,3142.9686 4095.7349,3142.9686 4095.7349,3160.1732"},{"type":"text","svgpath":"M 3984.4951 3178.4783 L 3984.4951 3182.7683 M 3984.4951 3178.4783 L 3987.1551 3178.4783 M 3984.4951 3180.5183 L 3986.1351 3180.5183 M 3989.9351 3178.4783 L 3989.9351 3182.7683 M 3988.5051 3178.4783 L 3991.3651 3178.4783 M 3992.9251 3179.4983 L 3992.9251 3179.2983 L 3993.1251 3178.8883 L 3993.3351 3178.6783 L 3993.7451 3178.4783 L 3994.5551 3178.4783 L 3994.9651 3178.6783 L 3995.1751 3178.8883 L 3995.3751 3179.2983 L 3995.3751 3179.7083 L 3995.1751 3180.1183 L 3994.7651 3180.7283 L 3992.7151 3182.7683 L 3995.5851 3182.7683 M 3997.3451 3178.4783 L 3999.5951 3178.4783 L 3998.3651 3180.1183 L 3998.9751 3180.1183 L 3999.3851 3180.3183 L 3999.5951 3180.5183 L 3999.7951 3181.1383 L 3999.7951 3181.5483 L 3999.5951 3182.1583 L 3999.1851 3182.5683 L 3998.5651 3182.7683 L 3997.9551 3182.7683 L 3997.3451 3182.5683 L 3997.1351 3182.3683 L 3996.9351 3181.9583 M 4001.3451 3179.4983 L 4001.3451 3179.2983 L 4001.5551 3178.8883 L 4001.7551 3178.6783 L 4002.1651 3178.4783 L 4002.9851 3178.4783 L 4003.3951 3178.6783 L 4003.5951 3178.8883 L 4003.8051 3179.2983 L 4003.8051 3179.7083 L 4003.5951 3180.1183 L 4003.1951 3180.7283 L 4001.1451 3182.7683 L 4004.0051 3182.7683 M 4005.3551 3178.4783 L 4005.3551 3182.7683 M 4005.3551 3178.4783 L 4007.1951 3178.4783 L 4007.8151 3178.6783 L 4008.0151 3178.8883 L 4008.2251 3179.2983 L 4008.2251 3179.7083 L 4008.0151 3180.1183 L 4007.8151 3180.3183 L 4007.1951 3180.5183 L 4005.3551 3180.5183 M 4006.7951 3180.5183 L 4008.2251 3182.7683 M 4009.5751 3178.4783 L 4009.5751 3182.7683 M 4009.5751 3182.7683 L 4012.0251 3182.7683 M 4016.5251 3178.4783 L 4016.5251 3181.5483 L 4016.7351 3182.1583 L 4017.1451 3182.5683 L 4017.7551 3182.7683 L 4018.1651 3182.7683 L 4018.7751 3182.5683 L 4019.1851 3182.1583 L 4019.3951 3181.5483 L 4019.3951 3178.4783 M 4023.6051 3179.0883 L 4023.1951 3178.6783 L 4022.5851 3178.4783 L 4021.7651 3178.4783 L 4021.1451 3178.6783 L 4020.7451 3179.0883 L 4020.7451 3179.4983 L 4020.9451 3179.9083 L 4021.1451 3180.1183 L 4021.5551 3180.3183 L 4022.7851 3180.7283 L 4023.1951 3180.9283 L 4023.3951 3181.1383 L 4023.6051 3181.5483 L 4023.6051 3182.1583 L 4023.1951 3182.5683 L 4022.5851 3182.7683 L 4021.7651 3182.7683 L 4021.1451 3182.5683 L 4020.7451 3182.1583 M 4024.9551 3178.4783 L 4024.9551 3182.7683 M 4024.9551 3178.4783 L 4026.7951 3178.4783 L 4027.4051 3178.6783 L 4027.6151 3178.8883 L 4027.8151 3179.2983 L 4027.8151 3179.7083 L 4027.6151 3180.1183 L 4027.4051 3180.3183 L 4026.7951 3180.5183 M 4024.9551 3180.5183 L 4026.7951 3180.5183 L 4027.4051 3180.7283 L 4027.6151 3180.9283 L 4027.8151 3181.3383 L 4027.8151 3181.9583 L 4027.6151 3182.3683 L 4027.4051 3182.5683 L 4026.7951 3182.7683 L 4024.9551 3182.7683 M 4032.9351 3178.4783 L 4032.9351 3181.9583 L 4033.1351 3182.5683 L 4033.5451 3182.7683 L 4033.9551 3182.7683 M 4032.3151 3179.9083 L 4033.7451 3179.9083 M 4036.3251 3179.9083 L 4035.9151 3180.1183 L 4035.5051 3180.5183 L 4035.3051 3181.1383 L 4035.3051 3181.5483 L 4035.5051 3182.1583 L 4035.9151 3182.5683 L 4036.3251 3182.7683 L 4036.9451 3182.7683 L 4037.3451 3182.5683 L 4037.7551 3182.1583 L 4037.9651 3181.5483 L 4037.9651 3181.1383 L 4037.7551 3180.5183 L 4037.3451 3180.1183 L 4036.9451 3179.9083 L 4036.3251 3179.9083 M 4043.8951 3178.4783 L 4043.8951 3182.7683 M 4042.4651 3178.4783 L 4045.3251 3178.4783 M 4048.1051 3178.4783 L 4048.1051 3182.7683 M 4046.6751 3178.4783 L 4049.5451 3178.4783 M 4050.8951 3178.4783 L 4050.8951 3182.7683 M 4050.8951 3182.7683 L 4053.3451 3182.7683 M 4057.8451 3178.4783 L 4057.8451 3182.7683 M 4057.8451 3178.4783 L 4059.4851 3182.7683 M 4061.1151 3178.4783 L 4059.4851 3182.7683 M 4061.1151 3178.4783 L 4061.1151 3182.7683 M 4063.4951 3179.9083 L 4063.0851 3180.1183 L 4062.6751 3180.5183 L 4062.4651 3181.1383 L 4062.4651 3181.5483 L 4062.6751 3182.1583 L 4063.0851 3182.5683 L 4063.4951 3182.7683 L 4064.1051 3182.7683 L 4064.5151 3182.5683 L 4064.9251 3182.1583 L 4065.1251 3181.5483 L 4065.1251 3181.1383 L 4064.9251 3180.5183 L 4064.5151 3180.1183 L 4064.1051 3179.9083 L 4063.4951 3179.9083 M 4068.9351 3178.4783 L 4068.9351 3182.7683 M 4068.9351 3180.5183 L 4068.5251 3180.1183 L 4068.1151 3179.9083 L 4067.4951 3179.9083 L 4067.0951 3180.1183 L 4066.6851 3180.5183 L 4066.4751 3181.1383 L 4066.4751 3181.5483 L 4066.6851 3182.1583 L 4067.0951 3182.5683 L 4067.4951 3182.7683 L 4068.1151 3182.7683 L 4068.5251 3182.5683 L 4068.9351 3182.1583 M 4070.2851 3179.9083 L 4070.2851 3181.9583 L 4070.4851 3182.5683 L 4070.8951 3182.7683 L 4071.5051 3182.7683 L 4071.9151 3182.5683 L 4072.5351 3181.9583 M 4072.5351 3179.9083 L 4072.5351 3182.7683 M 4073.8851 3178.4783 L 4073.8851 3182.7683 M 4075.2351 3181.1383 L 4077.6851 3181.1383 L 4077.6851 3180.7283 L 4077.4851 3180.3183 L 4077.2751 3180.1183 L 4076.8651 3179.9083 L 4076.2551 3179.9083 L 4075.8451 3180.1183 L 4075.4351 3180.5183 L 4075.2351 3181.1383 L 4075.2351 3181.5483 L 4075.4351 3182.1583 L 4075.8451 3182.5683 L 4076.2551 3182.7683 L 4076.8651 3182.7683 L 4077.2751 3182.5683 L 4077.6851 3182.1583","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","val":1},{"type":"text","svgpath":"M 4052 3083.04 L 4052 3079.97 L 4051.8 3079.36 L 4051.39 3078.95 L 4050.77 3078.75 L 4050.36 3078.75 L 4049.75 3078.95 L 4049.34 3079.36 L 4049.14 3079.97 L 4049.14 3083.04 M 4047.79 3082.22 L 4047.38 3082.43 L 4046.76 3083.04 L 4046.76 3078.75","useTrueTypeFontRendering":false,"thickness":0.6,"width":0.6,"net":"","ref":1},{"type":"text","svgpath":"M 4113.41 3152.3483 L 4113.41 3148.3283 L 4113.14 3147.5183 L 4112.61 3146.9883 L 4111.8 3146.7183 L 4111.26 3146.7183 L 4110.46 3146.9883 L 4109.92 3147.5183 L 4109.65 3148.3283 L 4109.65 3152.3483 M 4104.12 3151.5483 L 4104.66 3152.0883 L 4105.46 3152.3483 L 4106.54 3152.3483 L 4107.34 3152.0883 L 4107.88 3151.5483 L 4107.88 3151.0083 L 4107.61 3150.4783 L 4107.34 3150.2083 L 4106.81 3149.9383 L 4105.2 3149.3983 L 4104.66 3149.1283 L 4104.39 3148.8583 L 4104.12 3148.3283 L 4104.12 3147.5183 L 4104.66 3146.9883 L 4105.46 3146.7183 L 4106.54 3146.7183 L 4107.34 3146.9883 L 4107.88 3147.5183 M 4102.35 3152.3483 L 4102.35 3146.7183 M 4102.35 3152.3483 L 4099.94 3152.3483 L 4099.13 3152.0883 L 4098.86 3151.8183 L 4098.59 3151.2783 L 4098.59 3150.7383 L 4098.86 3150.2083 L 4099.13 3149.9383 L 4099.94 3149.6683 M 4102.35 3149.6683 L 4099.94 3149.6683 L 4099.13 3149.3983 L 4098.86 3149.1283 L 4098.59 3148.5983 L 4098.59 3147.7883 L 4098.86 3147.2483 L 4099.13 3146.9883 L 4099.94 3146.7183 L 4102.35 3146.7183","useTrueTypeFontRendering":false,"thickness":0.8,"width":0.8,"net":""},{"type":"text","svgpath":"M 4147.5 3030.03 L 4147.5 3033.79 M 4147.5 3030.03 L 4148.93 3033.79 M 4150.36 3030.03 L 4148.93 3033.79 M 4150.36 3030.03 L 4150.36 3033.79 M 4151.54 3030.03 L 4151.54 3033.79 M 4151.54 3030.03 L 4152.8 3030.03 L 4153.33 3030.21 L 4153.69 3030.56 L 4153.87 3030.92 L 4154.05 3031.46 L 4154.05 3032.35 L 4153.87 3032.89 L 4153.69 3033.25 L 4153.33 3033.61 L 4152.8 3033.79 L 4151.54 3033.79 M 4155.23 3032.17 L 4158.45 3032.17 M 4159.63 3030.56 L 4162.5 3032.17 L 4159.63 3033.79","useTrueTypeFontRendering":false,"thickness":0.8,"width":0.8,"net":""},{"type":"text","svgpath":"M 4052.36 3030.56 L 4049.5 3032.17 L 4052.36 3033.79 M 4053.54 3032.17 L 4056.77 3032.17 M 4057.95 3030.03 L 4057.95 3033.79 M 4057.95 3030.03 L 4059.38 3033.79 M 4060.81 3030.03 L 4059.38 3033.79 M 4060.81 3030.03 L 4060.81 3033.79 M 4064.5 3030.56 L 4064.14 3030.21 L 4063.6 3030.03 L 4062.89 3030.03 L 4062.35 3030.21 L 4061.99 3030.56 L 4061.99 3030.92 L 4062.17 3031.28 L 4062.35 3031.46 L 4062.71 3031.64 L 4063.78 3032 L 4064.14 3032.17 L 4064.32 3032.35 L 4064.5 3032.71 L 4064.5 3033.25 L 4064.14 3033.61 L 4063.6 3033.79 L 4062.89 3033.79 L 4062.35 3033.61 L 4061.99 3033.25 M 4065.68 3030.03 L 4068.18 3033.79 M 4068.18 3030.03 L 4065.68 3033.79","useTrueTypeFontRendering":false,"thickness":0.8,"width":0.8,"net":""},{"type":"text","svgpath":"M 4053.5 3097.53 L 4054.93 3101.29 M 4056.36 3097.53 L 4054.93 3101.29 M 4060.23 3098.42 L 4060.05 3098.06 L 4059.69 3097.71 L 4059.33 3097.53 L 4058.62 3097.53 L 4058.26 3097.71 L 4057.9 3098.06 L 4057.72 3098.42 L 4057.54 3098.96 L 4057.54 3099.85 L 4057.72 3100.39 L 4057.9 3100.75 L 4058.26 3101.11 L 4058.62 3101.29 L 4059.33 3101.29 L 4059.69 3101.11 L 4060.05 3100.75 L 4060.23 3100.39 M 4064.09 3098.42 L 4063.92 3098.06 L 4063.56 3097.71 L 4063.2 3097.53 L 4062.48 3097.53 L 4062.13 3097.71 L 4061.77 3098.06 L 4061.59 3098.42 L 4061.41 3098.96 L 4061.41 3099.85 L 4061.59 3100.39 L 4061.77 3100.75 L 4062.13 3101.11 L 4062.48 3101.29 L 4063.2 3101.29 L 4063.56 3101.11 L 4063.92 3100.75 L 4064.09 3100.39","useTrueTypeFontRendering":false,"thickness":0.8,"width":0.8,"net":""}],"B":[{"type":"text","svgpath":"M 4065.0455 3056.4545 L 4065.7273 3056.2273 L 4066.1818 3055.7727 L 4066.4091 3055.0909 L 4066.4091 3054.8636 L 4066.1818 3054.1818 L 4065.7273 3053.7273 L 4065.0455 3053.5 L 4064.8182 3053.5 L 4064.1364 3053.7273 L 4063.6818 3054.1818 L 4063.4545 3054.8636 L 4063.4545 3055.0909 L 4063.6818 3055.7727 L 4064.1364 3056.2273 L 4065.0455 3056.4545 L 4066.1818 3056.4545 L 4067.3182 3056.2273 L 4068 3055.7727 L 4068.2273 3055.0909 L 4068.2273 3054.6364 L 4068 3053.9545 L 4067.5455 3053.7273","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"text","svgpath":"M 4064.1364 3088.7273 L 4063.6818 3088.5 L 4063.4545 3087.8182 L 4063.4545 3087.3636 L 4063.6818 3086.6818 L 4064.3636 3086.2273 L 4065.5 3086 L 4066.6364 3086 L 4067.5455 3086.2273 L 4068 3086.6818 L 4068.2273 3087.3636 L 4068.2273 3087.5909 L 4068 3088.2727 L 4067.5455 3088.7273 L 4066.8636 3088.9545 L 4066.6364 3088.9545 L 4065.9545 3088.7273 L 4065.5 3088.2727 L 4065.2727 3087.5909 L 4065.2727 3087.3636 L 4065.5 3086.6818 L 4065.9545 3086.2273 L 4066.6364 3086","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"text","svgpath":"M 4145.3634 3088.9999 L 4146.0452 3088.7727 L 4146.4997 3088.3181 L 4146.727 3087.6363 L 4146.727 3087.409 L 4146.4997 3086.7272 L 4146.0452 3086.2727 L 4145.3634 3086.0454 L 4145.1361 3086.0454 L 4144.4543 3086.2727 L 4143.9997 3086.7272 L 4143.7724 3087.409 L 4143.7724 3087.6363 L 4143.9997 3088.3181 L 4144.4543 3088.7727 L 4145.3634 3088.9999 L 4146.4997 3088.9999 L 4147.6361 3088.7727 L 4148.3179 3088.3181 L 4148.5452 3087.6363 L 4148.5452 3087.1818 L 4148.3179 3086.4999 L 4147.8634 3086.2727","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""},{"type":"text","svgpath":"M 4147.8636 3053.7727 L 4148.3182 3054 L 4148.5455 3054.6818 L 4148.5455 3055.1364 L 4148.3182 3055.8182 L 4147.6364 3056.2727 L 4146.5 3056.5 L 4145.3636 3056.5 L 4144.4545 3056.2727 L 4144 3055.8182 L 4143.7727 3055.1364 L 4143.7727 3054.9091 L 4144 3054.2273 L 4144.4545 3053.7727 L 4145.1364 3053.5455 L 4145.3636 3053.5455 L 4146.0455 3053.7727 L 4146.5 3054.2273 L 4146.7273 3054.9091 L 4146.7273 3055.1364 L 4146.5 3055.8182 L 4146.0455 3056.2727 L 4145.3636 3056.5","useTrueTypeFontRendering":false,"thickness":0.5,"width":0.5,"net":""}]},"fabrication":{"F":[],"B":[]}},"footprints":[{"ref":"FUSE1","center":[4149,3109],"bbox":{"pos":[4149,3109],"angle":180,"relpos":[-5.5,-2.4999999999995453],"size":[11,5]},"pads":[{"layers":["F"],"pos":[4146.034,3109],"size":[3.1751,3.4016],"angle":-180,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4146.0345,"y":3109},"polygon":[{"x":4147.622,"y":3107.2992},{"x":4147.622,"y":3110.7008},{"x":4144.4469,"y":3110.7008},{"x":4144.4469,"y":3107.2992}],"net":"VCC"},{"layers":["F"],"pos":[4151.966,3109],"size":[3.1751,3.4016],"angle":-180,"pin1":1,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4151.9655,"y":3109},"polygon":[{"x":4150.378,"y":3107.2992},{"x":4150.378,"y":3110.7008},{"x":4153.5531,"y":3110.7008},{"x":4153.5531,"y":3107.2992}],"net":"FUSE1_1"}],"drawings":[],"layer":"F"},{"ref":"LED1","center":[4056.5,3108.5],"bbox":{"pos":[4056.5,3108.5],"angle":90,"relpos":[-5.864599999999427,-2.978700000000117],"size":[11.33889999999974,5.915100000000166]},"pads":[{"layers":["F"],"pos":[4056.486,3105.353],"size":[3.1496,3.1496],"angle":-180,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4056.4861,"y":3105.3524},"polygon":[{"x":4058.0609,"y":3106.9274},{"x":4054.9113,"y":3106.9274},{"x":4054.9113,"y":3103.7778},{"x":4058.0609,"y":3103.7778}],"net":"VCC"},{"layers":["F"],"pos":[4056.514,3111.648],"size":[3.1496,3.1496],"angle":-180,"pin1":1,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4056.5137,"y":3111.6475},"polygon":[{"x":4058.0885,"y":3113.2227},{"x":4054.9389,"y":3113.2227},{"x":4054.9389,"y":3110.0731},{"x":4058.0885,"y":3110.0731}],"net":"LED1_1"}],"drawings":[],"layer":"F"},{"ref":"D1","center":[4158.5,3104.5],"bbox":{"pos":[4158.5,3104.5],"angle":90,"relpos":[-6.092399999999543,-3.159099999999853],"size":[12.184799999999996,6.318199999999706]},"pads":[{"layers":["F"],"pos":[4158.5,3099.884],"size":[3.937,2.9528],"angle":-90,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4158.5,"y":3099.8835},"polygon":[{"x":4157.0236,"y":3101.8522},{"x":4157.0236,"y":3097.9151},{"x":4159.9764,"y":3097.9151},{"x":4159.9764,"y":3101.8522}],"net":"VCC-IN"},{"layers":["F"],"pos":[4158.5,3109.116],"size":[3.937,2.9528],"angle":-90,"pin1":1,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4158.5,"y":3109.1163},"polygon":[{"x":4157.0236,"y":3111.0847},{"x":4157.0236,"y":3107.1476},{"x":4159.9764,"y":3107.1476},{"x":4159.9764,"y":3111.0847}],"net":"FUSE1_1"}],"drawings":[],"layer":"F"},{"ref":"R1","center":[4063.5,3108.5],"bbox":{"pos":[4063.5,3108.5],"angle":90,"relpos":[-5.453099999999722,-2.600800000000163],"size":[10.906200000000354,5.201600000000326]},"pads":[{"layers":["F"],"pos":[4063.5,3105.534],"size":[3.1751,3.4016],"angle":-90,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4063.5,"y":3105.5345},"polygon":[{"x":4065.2008,"y":3107.122},{"x":4061.7992,"y":3107.122},{"x":4061.7992,"y":3103.9469},{"x":4065.2008,"y":3103.9469}],"net":"GND"},{"layers":["F"],"pos":[4063.5,3111.466],"size":[3.1751,3.4016],"angle":-90,"pin1":1,"shape":"rect","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4063.5,"y":3111.4655},"polygon":[{"x":4065.2008,"y":3109.878},{"x":4061.7992,"y":3109.878},{"x":4061.7992,"y":3113.0531},{"x":4065.2008,"y":3113.0531}],"net":"LED1_1"}],"drawings":[],"layer":"F"},{"ref":"P1","center":[4035.5,3071.5],"bbox":{"pos":[4035.5,3071.5],"angle":90,"relpos":[-40.81999999999971,-33.52210000000014],"size":[82,66.25210000000015]},"pads":[{"layers":["B"],"pos":[4054.223,3055.12],"size":[13.78,6.6929],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.223,"y":3055.12},"polygon":[{"x":4047.333,"y":3058.467},{"x":4047.333,"y":3051.774},{"x":4061.113,"y":3051.774},{"x":4061.113,"y":3058.467}],"net":"GND"},{"layers":["B"],"pos":[4054.223,3065.92],"size":[13.78,6.6931],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.223,"y":3065.92},"polygon":[{"x":4047.333,"y":3069.267},{"x":4047.333,"y":3062.574},{"x":4061.113,"y":3062.574},{"x":4061.113,"y":3069.267}],"net":""},{"layers":["B"],"pos":[4054.223,3076.72],"size":[13.78,6.6931],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.223,"y":3076.72},"polygon":[{"x":4047.333,"y":3080.067},{"x":4047.333,"y":3073.374},{"x":4061.113,"y":3073.374},{"x":4061.113,"y":3080.067}],"net":"DSR"},{"layers":["B"],"pos":[4054.223,3087.52],"size":[13.78,6.6919],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.223,"y":3087.52},"polygon":[{"x":4047.333,"y":3090.866},{"x":4047.333,"y":3084.174},{"x":4061.113,"y":3084.174},{"x":4061.113,"y":3090.866}],"net":"DTR"},{"layers":["F"],"pos":[4054.221,3049.721],"size":[13.7791,6.6931],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.221,"y":3049.721},"polygon":[{"x":4047.332,"y":3053.067},{"x":4047.332,"y":3046.374},{"x":4061.111,"y":3046.374},{"x":4061.111,"y":3053.067}],"net":"VCC-IN"},{"layers":["F"],"pos":[4054.221,3060.519],"size":[13.7791,6.6929],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.221,"y":3060.519},"polygon":[{"x":4047.332,"y":3063.866},{"x":4047.332,"y":3057.173},{"x":4061.111,"y":3057.173},{"x":4061.111,"y":3063.866}],"net":"CTS"},{"layers":["F"],"pos":[4054.222,3071.32],"size":[13.78,6.6929],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.222,"y":3071.32},"polygon":[{"x":4047.332,"y":3074.667},{"x":4047.332,"y":3067.974},{"x":4061.112,"y":3067.974},{"x":4061.112,"y":3074.667}],"net":"RTS"},{"layers":["F"],"pos":[4054.221,3082.121],"size":[13.7791,6.6929],"angle":-90,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.221,"y":3082.121},"polygon":[{"x":4047.332,"y":3085.467},{"x":4047.332,"y":3078.774},{"x":4061.111,"y":3078.774},{"x":4061.111,"y":3085.467}],"net":"RXD"},{"layers":["F"],"pos":[4054.221,3092.919],"size":[13.7791,6.6931],"angle":-90,"pin1":1,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4054.221,"y":3092.919},"polygon":[{"x":4047.332,"y":3096.266},{"x":4047.332,"y":3089.573},{"x":4061.111,"y":3089.573},{"x":4061.111,"y":3096.266}],"net":"TXD"}],"drawings":[],"layer":"F"},{"ref":"P2","center":[4176.5,3071],"bbox":{"pos":[4176.5,3071],"angle":270,"relpos":[-40.81999999999971,-33.52210000000014],"size":[82,66.2520999999997]},"pads":[{"layers":["B"],"pos":[4157.777,3087.38],"size":[13.78,6.6929],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.777,"y":3087.38},"polygon":[{"x":4164.667,"y":3084.033},{"x":4164.667,"y":3090.726},{"x":4150.887,"y":3090.726},{"x":4150.887,"y":3084.033}],"net":"DSR"},{"layers":["B"],"pos":[4157.777,3076.58],"size":[13.78,6.6931],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.777,"y":3076.58},"polygon":[{"x":4164.667,"y":3073.233},{"x":4164.667,"y":3079.926},{"x":4150.887,"y":3079.926},{"x":4150.887,"y":3073.233}],"net":"GND"},{"layers":["B"],"pos":[4157.777,3065.78],"size":[13.78,6.6931],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.777,"y":3065.78},"polygon":[{"x":4164.667,"y":3062.433},{"x":4164.667,"y":3069.126},{"x":4150.887,"y":3069.126},{"x":4150.887,"y":3062.433}],"net":"DCD"},{"layers":["B"],"pos":[4157.777,3054.98],"size":[13.78,6.6919],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.777,"y":3054.98},"polygon":[{"x":4164.667,"y":3051.634},{"x":4164.667,"y":3058.326},{"x":4150.887,"y":3058.326},{"x":4150.887,"y":3051.634}],"net":"DTR"},{"layers":["F"],"pos":[4157.779,3092.779],"size":[13.7791,6.6931],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.779,"y":3092.779},"polygon":[{"x":4164.668,"y":3089.433},{"x":4164.668,"y":3096.126},{"x":4150.889,"y":3096.126},{"x":4150.889,"y":3089.433}],"net":"VCC-IN"},{"layers":["F"],"pos":[4157.779,3081.981],"size":[13.7791,6.6929],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.779,"y":3081.981},"polygon":[{"x":4164.668,"y":3078.634},{"x":4164.668,"y":3085.327},{"x":4150.889,"y":3085.327},{"x":4150.889,"y":3078.634}],"net":"CTS"},{"layers":["F"],"pos":[4157.778,3071.18],"size":[13.78,6.6929],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.778,"y":3071.18},"polygon":[{"x":4164.668,"y":3067.833},{"x":4164.668,"y":3074.526},{"x":4150.888,"y":3074.526},{"x":4150.888,"y":3067.833}],"net":"RTS"},{"layers":["F"],"pos":[4157.779,3060.379],"size":[13.7791,6.6929],"angle":-270,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.779,"y":3060.379},"polygon":[{"x":4164.668,"y":3057.033},{"x":4164.668,"y":3063.726},{"x":4150.889,"y":3063.726},{"x":4150.889,"y":3057.033}],"net":"RXD"},{"layers":["F"],"pos":[4157.779,3049.581],"size":[13.7791,6.6931],"angle":-270,"pin1":1,"shape":"polygon","type":"smd","drillsize":[0,0],"holeCenterPoint":{"x":4157.779,"y":3049.581},"polygon":[{"x":4164.668,"y":3046.234},{"x":4164.668,"y":3052.927},{"x":4150.889,"y":3052.927},{"x":4150.889,"y":3046.234}],"net":"TXD"}],"drawings":[],"layer":"F"},{"ref":"U1","center":[4106,3071],"bbox":{"pos":[4106,3071],"angle":180,"relpos":[-35.43509999999969,-89.17319999999972],"size":[70.86999999999989,135.82490000000007]},"pads":[{"layers":["F","B"],"pos":[4135.527,3111.118],"size":[6,6],"angle":-180,"pin1":1,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3111.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3101.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3101.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3091.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3091.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3081.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3081.1181},"polygon":[],"net":"CTS"},{"layers":["F","B"],"pos":[4135.527,3071.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3071.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3061.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3061.1181},"polygon":[],"net":"VCC"},{"layers":["F","B"],"pos":[4135.527,3051.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3051.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3041.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3041.1181},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4135.527,3031.118],"size":[6,6],"angle":-180,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4135.5276,"y":3031.1181},"polygon":[],"net":"GND"},{"layers":["F","B"],"pos":[4076.472,3030.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3030.8819},"polygon":[],"net":"TXD"},{"layers":["F","B"],"pos":[4076.472,3040.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3040.8819},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4076.472,3050.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3050.8819},"polygon":[],"net":"RTS"},{"layers":["F","B"],"pos":[4076.472,3060.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3060.8819},"polygon":[],"net":"VCC"},{"layers":["F","B"],"pos":[4076.472,3070.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3070.8819},"polygon":[],"net":"RXD"},{"layers":["F","B"],"pos":[4076.472,3080.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3080.8819},"polygon":[],"net":""},{"layers":["F","B"],"pos":[4076.472,3090.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3090.8819},"polygon":[],"net":"GND"},{"layers":["F","B"],"pos":[4076.472,3100.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3100.8819},"polygon":[],"net":"DSR"},{"layers":["F","B"],"pos":[4076.472,3110.882],"size":[6,6],"angle":0,"shape":"oval","type":"th","drillsize":[3.6,3.6],"holeCenterPoint":{"x":4076.4725,"y":3110.8819},"polygon":[],"net":"DCD"}],"drawings":[],"layer":"F"}],"metadata":{"title":"PCB_VSIF for MSX","revision":"0","company":"Unknown Company","date":"2023-10-20"},"tracks":{"F":[{"type":"polyline","net":"TXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2211,3092.919 4062.2261,3092.919"},{"type":"polyline","net":"TXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4062.2261,3092.919 4062.2261,3086.318 4072.3511,3076.193 4072.3511,3075.765"},{"type":"polyline","net":"TXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3030.882 4081.7081,3036.118 4137.4261,3036.118 4149.7741,3048.466 4149.7741,3049.581"},{"type":"polyline","net":"TXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7791,3049.581 4149.7741,3049.581"},{"type":"polyline","net":"RXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2211,3082.121 4062.2261,3082.121"},{"type":"polyline","net":"RXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3070.882 4073.4651,3070.882 4062.2261,3082.121"},{"type":"polyline","net":"RXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7791,3060.379 4149.7741,3060.379"},{"type":"polyline","net":"RXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7741,3060.379 4149.7741,3059.471 4137.2211,3046.918 4104.7931,3046.918"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7781,3071.18 4149.7731,3071.18"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7731,3071.18 4149.7731,3066.718 4138.3021,3055.247 4093.4761,3055.247 4092.7361,3054.507"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2221,3071.32 4062.2271,3071.32"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4062.2271,3071.32 4067.4921,3066.055 4077.9091,3066.055"},{"type":"polyline","net":"CTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4135.5271,3081.118 4103.4041,3081.118 4078.8721,3056.586 4066.1591,3056.586 4062.2261,3060.519"},{"type":"polyline","net":"CTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2211,3060.519 4062.2261,3060.519"},{"type":"polyline","net":"CTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7791,3081.981 4149.7741,3081.981"},{"type":"polyline","net":"CTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7741,3081.981 4149.0471,3081.981"},{"type":"polyline","net":"DSR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3100.882 4081.2361,3096.118 4141.0341,3096.118"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4063.5001,3105.534 4063.5001,3102.832"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3090.882 4075.4501,3090.882 4063.5001,3102.832"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3090.882 4081.2361,3086.118 4140.2341,3086.118"},{"type":"polyline","net":"VCC-IN","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7791,3092.779 4158.5001,3093.5 4158.5001,3099.883"},{"type":"polyline","net":"VCC-IN","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2211,3049.721 4062.2261,3049.721"},{"type":"polyline","net":"VCC-IN","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7791,3092.779 4149.7741,3092.779"},{"type":"polyline","net":"VCC-IN","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4062.2261,3049.721 4065.3691,3046.578 4081.2751,3046.578 4091.5751,3056.878 4137.1981,3056.878 4146.0161,3065.696 4146.0161,3089.021 4149.7741,3092.779"},{"type":"polyline","net":"LED1_1","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4060.6841,3111.466 4060.5031,3111.647 4056.5131,3111.647"},{"type":"polyline","net":"LED1_1","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4063.5001,3111.466 4060.6841,3111.466"},{"type":"polyline","net":"FUSE1_1","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4158.5001,3109.116 4154.7841,3109.116 4154.6681,3109"},{"type":"polyline","net":"FUSE1_1","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4151.9661,3109 4154.6681,3109"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4056.4861,3105.352 4059.1751,3105.352"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4146.0341,3109 4143.3321,3109"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4059.1751,3105.352 4059.1751,3102.373 4071.7541,3089.794 4071.7541,3079.749 4075.6211,3075.882 4077.5951,3075.882 4080.6511,3072.826 4080.6511,3065.061 4076.4721,3060.882"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4143.3321,3109 4140.9811,3106.649"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4140.9811,3106.649 4070.4131,3106.649 4068.8191,3108.243 4060.7211,3108.243 4059.1751,3106.697 4059.1751,3105.352"},{"type":"polyline","net":"VCC","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4135.5271,3061.118 4143.5421,3069.133 4143.5421,3104.088 4140.9811,3106.649"},{"start":[4140.234,3086.118],"end":[4140.234,3086.118],"width":2.4016,"net":"GND"},{"start":[4141.034,3096.118],"end":[4141.034,3096.118],"width":2.4016,"net":"DSR"},{"start":[4149.047,3081.981],"end":[4149.047,3081.981],"width":2.4016,"net":"CTS"},{"start":[4077.909,3066.055],"end":[4077.909,3066.055],"width":2.4016,"net":"RTS"},{"start":[4092.736,3054.507],"end":[4092.736,3054.507],"width":2.4016,"net":"RTS"},{"start":[4104.793,3046.918],"end":[4104.793,3046.918],"width":2.4016,"net":"RXD"},{"start":[4072.351,3075.765],"end":[4072.351,3075.765],"width":2.4016,"net":"TXD"}],"B":[{"type":"polyline","net":"DCD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3110.882 4092.0171,3110.882 4126.7811,3076.118 4139.4341,3076.118 4149.7721,3065.78"},{"type":"polyline","net":"DCD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7771,3065.78 4149.7721,3065.78"},{"type":"polyline","net":"TXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3030.882 4072.3511,3035.003 4072.3511,3075.765"},{"type":"polyline","net":"RXD","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3070.882 4080.8291,3070.882 4104.7931,3046.918"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4080.5931,3054.507 4092.7361,3054.507"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3050.882 4076.9681,3050.882 4080.5931,3054.507"},{"type":"polyline","net":"RTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4080.5931,3054.507 4080.5931,3063.371 4077.9091,3066.055"},{"type":"polyline","net":"CTS","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4135.5271,3081.118 4135.5271,3084.992 4139.1241,3088.589 4142.4391,3088.589 4149.0471,3081.981"},{"type":"polyline","net":"DTR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7721,3054.98 4148.3271,3056.425 4133.2491,3056.425 4084.6261,3105.048 4074.4081,3105.048 4062.2281,3092.868 4062.2281,3087.52"},{"type":"polyline","net":"DTR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7771,3054.98 4149.7721,3054.98"},{"type":"polyline","net":"DTR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2231,3087.52 4062.2281,3087.52"},{"type":"polyline","net":"DSR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4076.4721,3100.882 4076.4721,3097.465 4062.2281,3083.221 4062.2281,3076.72"},{"type":"polyline","net":"DSR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2231,3076.72 4062.2281,3076.72"},{"type":"polyline","net":"DSR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7771,3087.38 4149.7721,3087.38"},{"type":"polyline","net":"DSR","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7721,3087.38 4141.0341,3096.118"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4077.1431,3087.567 4076.4721,3088.238 4076.4721,3090.882"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4054.2231,3055.12 4062.2281,3055.12"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4062.2281,3055.12 4065.1851,3058.077 4065.1851,3075.609 4077.1431,3087.567"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4135.5271,3031.118 4133.5921,3031.118 4077.1431,3087.567"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4157.7771,3076.58 4149.7721,3076.58"},{"type":"polyline","net":"GND","start":[0,0],"end":[0,0],"width":1,"svgpath":"M4149.7721,3076.58 4140.2341,3086.118"},{"start":[4140.234,3086.118],"end":[4140.234,3086.118],"width":2.4016,"net":"GND"},{"start":[4141.034,3096.118],"end":[4141.034,3096.118],"width":2.4016,"net":"DSR"},{"start":[4149.047,3081.981],"end":[4149.047,3081.981],"width":2.4016,"net":"CTS"},{"start":[4077.909,3066.055],"end":[4077.909,3066.055],"width":2.4016,"net":"RTS"},{"start":[4092.736,3054.507],"end":[4092.736,3054.507],"width":2.4016,"net":"RTS"},{"start":[4104.793,3046.918],"end":[4104.793,3046.918],"width":2.4016,"net":"RXD"},{"start":[4072.351,3075.765],"end":[4072.351,3075.765],"width":2.4016,"net":"TXD"}]},"zones":{"F":[{"net":"GND","svgpath":"M 4149.59493 3045.99754 L 4149.45641 3045.96264 4149.33899 3045.88129 4138.5148 3035.05709 4138.26949 3034.85578 4138.09721 3034.73193 4138.02344 3034.6017 4138.00272 3034.45346 4138.03793 3034.30799 4138.12416 3034.18564 4138.50838 3033.81405 4138.84112 3033.3927 4139.11473 3032.93076 4139.1413 3032.8681 4137.2776 3032.8681 4137.2776 3034.198 4137.24715 3034.35107 4137.16044 3034.48084 4137.03067 3034.56755 4136.8776 3034.598 4134.1776 3034.598 4134.02453 3034.56755 4133.89476 3034.48084 4133.80805 3034.35107 4133.7776 3034.198 4133.7776 3032.8681 4131.91887 3032.8681 4132.06956 3033.1663 4132.37341 3033.60894 4132.66351 3033.92969 4132.74247 3034.06049 4132.76662 3034.21137 4132.73245 3034.36029 4132.64492 3034.48553 4132.51683 3034.56882 4132.36685 3034.598 4082.50339 3034.598 4082.35032 3034.56755 4082.22055 3034.48084 4080.35456 3032.61486 4080.27091 3032.49226 4080.23771 3032.34761 4080.25954 3032.2008 4080.3488 3031.94373 4080.45574 3031.41759 4080.4916 3030.8819 4080.45574 3030.34621 4080.3488 3029.82007 4080.17269 3029.31288 4079.93054 3028.8337 4079.62669 3028.39106 4079.44332 3028.18831 4079.36436 3028.05751 4079.3402 3027.90663 4079.37438 3027.75771 4079.4619 3027.63247 4079.59 3027.54918 4079.73998 3027.52 4132.47957 3027.52 4132.63777 3027.55262 4132.77018 3027.64514 4132.85519 3027.78249 4132.87895 3027.94227 4132.83758 3028.09841 4132.73355 3028.22907 4132.37341 3028.62726 4132.06956 3029.0699 4131.91887 3029.3681 4133.7776 3029.3681 4133.7776 3027.92 4133.80805 3027.76693 4133.89476 3027.63716 4134.02453 3027.55045 4134.1776 3027.52 4136.8776 3027.52 4137.03067 3027.55045 4137.16044 3027.63716 4137.24715 3027.76693 4137.2776 3027.92 4137.2776 3029.3681 4139.1413 3029.3681 4139.11473 3029.30544 4138.84112 3028.8435 4138.50838 3028.42215 4138.28647 3028.20753 4138.19716 3028.0782 4138.16457 3027.92446 4138.19372 3027.77002 4138.28013 3027.63874 4138.41044 3027.55088 4138.56454 3027.52 4164.08 3027.52 4164.23307 3027.55045 4164.36284 3027.63716 4164.44955 3027.76693 4164.48 3027.92 4164.48 3044.814 4164.44955 3044.96707 4164.36284 3045.09684 4164.23307 3045.18355 4164.08 3045.214 4150.91146 3045.214 4150.66259 3045.24204 4150.44754 3045.31729 4150.25462 3045.43851 4150.09351 3045.59962 4149.96053 3045.81126 4149.86415 3045.9167 4149.73688 3045.98155 4149.59493 3045.99754 Z "},{"net":"GND","svgpath":"M 4068.17688 3106.69255 L 4068.02381 3106.723 4066.6208 3106.723 4066.45067 3106.68502 4066.31285 3106.57827 4064.50835 3106.57827 4064.37053 3106.68502 4064.2004 3106.723 4062.7996 3106.723 4062.62947 3106.68502 4062.49165 3106.57827 4061.37167 3106.57827 4061.21859 3106.54783 4061.08882 3106.46112 4060.81226 3106.18455 4060.72555 3106.05478 4060.6951 3105.90171 4060.6951 3104.89072 4060.72555 3104.73765 4060.81226 3104.60788 4060.94203 3104.52117 4061.0951 3104.49072 4062.3996 3104.49072 4062.3996 3102.92695 4061.82166 3102.92695 4061.61057 3102.91715 4061.46756 3102.83811 4061.36808 3102.70847 4061.32875 3102.54988 4061.35612 3102.38878 4061.44563 3102.25208 4072.81501 3090.8827 4073.01632 3090.63739 4073.15661 3090.37494 4073.243 3090.09016 4073.2741 3089.77435 4073.2741 3089.5319 4073.30455 3089.37883 4073.39126 3089.24906 4073.52103 3089.16235 4073.6741 3089.1319 4074.7225 3089.1319 4074.7225 3087.26811 4074.30989 3087.49423 4073.91137 3087.78786 4073.75115 3087.85834 4073.57618 3087.85366 4073.41996 3087.77472 4073.3124 3087.63663 4073.2741 3087.46583 4073.2741 3084.29797 4073.3124 3084.12717 4073.41996 3083.98908 4073.57618 3083.91014 4073.75115 3083.90546 4073.91137 3083.97594 4074.30989 3084.26957 4074.78072 3084.52759 4075.28174 3084.72056 4075.804 3084.84502 4076.3382 3084.89876 4076.8748 3084.88082 4077.40421 3084.79152 4077.917 3084.63245 4078.40401 3084.40645 4078.85655 3084.11756 4079.26655 3083.77093 4079.62669 3083.37274 4079.93054 3082.9301 4080.17269 3082.45092 4080.3488 3081.94373 4080.45574 3081.41759 4080.4916 3080.8819 4080.45574 3080.34621 4080.3488 3079.82007 4080.17269 3079.31288 4079.93054 3078.8337 4079.62669 3078.39106 4079.26655 3077.99287 4078.85655 3077.64624 4078.74151 3077.5728 4078.61692 3077.44663 4078.5591 3077.27901 4078.57943 3077.10286 4078.6739 3076.9528 4081.71201 3073.9147 4081.91332 3073.66939 4082.05361 3073.40694 4082.14 3073.12216 4082.1711 3072.80635 4082.1711 3065.08065 4082.14 3064.76484 4082.05361 3064.48006 4081.91332 3064.21761 4081.71201 3063.9723 4080.35456 3062.61486 4080.27091 3062.49226 4080.23771 3062.34761 4080.25954 3062.2008 4080.3488 3061.94373 4080.45574 3061.41759 4080.4658 3061.26738 4080.50445 3061.12069 4080.59494 3060.99894 4080.72427 3060.91964 4080.87382 3060.8942 4081.02209 3060.92627 4081.14775 3061.01125 4102.3154 3082.17891 4102.56071 3082.38022 4102.82316 3082.52051 4103.10794 3082.6069 4103.42375 3082.638 4131.55655 3082.638 4131.70031 3082.66473 4131.82487 3082.74134 4131.91356 3082.8576 4132.06956 3083.1663 4132.37341 3083.60894 4132.73355 3084.00713 4133.14355 3084.35376 4133.59609 3084.64265 4134.0831 3084.86865 4134.59589 3085.02772 4135.1253 3085.11702 4135.6619 3085.13496 4136.1961 3085.08122 4136.71836 3084.95676 4137.21938 3084.76379 4137.69021 3084.50577 4138.12245 3084.1873 4138.50838 3083.81405 4138.84112 3083.3927 4139.11473 3082.93076 4139.32432 3082.43647 4139.46617 3081.91865 4139.53773 3081.38655 4139.53773 3080.84965 4139.46617 3080.31755 4139.32432 3079.79973 4139.11473 3079.30544 4138.84112 3078.8435 4138.50838 3078.42215 4138.12245 3078.0489 4137.69021 3077.73043 4137.21938 3077.47241 4136.71836 3077.27944 4136.1961 3077.15498 4135.6619 3077.10124 4135.1253 3077.11918 4134.59589 3077.20848 4134.0831 3077.36755 4133.59609 3077.59355 4133.14355 3077.88244 4132.73355 3078.22907 4132.37341 3078.62726 4132.06956 3079.0699 4131.91366 3079.3784 4131.82497 3079.49466 4131.70042 3079.57127 4131.55665 3079.598 4104.19939 3079.598 4104.04632 3079.56755 4103.91655 3079.48084 4079.9608 3055.52509 4079.71549 3055.32378 4079.45304 3055.18349 4079.16826 3055.0971 4078.85245 3055.066 4078.74082 3055.066 4078.57447 3055.02977 4078.43825 3054.92764 4078.35685 3054.77811 4078.345 3054.60827 4078.40486 3054.44889 4078.52558 3054.32884 4078.85655 3054.11756 4079.26655 3053.77093 4079.62669 3053.37274 4079.93054 3052.9301 4080.17269 3052.45092 4080.3488 3051.94373 4080.45574 3051.41759 4080.4916 3050.8819 4080.45574 3050.34621 4080.3488 3049.82007 4080.17269 3049.31288 4079.93054 3048.8337 4079.8555 3048.72438 4079.79085 3048.56453 4079.79949 3048.39232 4079.87982 3048.23975 4080.0169 3048.13516 4080.18528 3048.098 4080.47981 3048.098 4080.63288 3048.12845 4080.76265 3048.21516 4090.4864 3057.93891 4090.73171 3058.14022 4090.99416 3058.28051 4091.27894 3058.3669 4091.59475 3058.398 4131.77103 3058.398 4131.9394 3058.43516 4132.07649 3058.53975 4132.15681 3058.69232 4132.16545 3058.86453 4132.1008 3059.02438 4132.06956 3059.0699 4131.82741 3059.54908 4131.6513 3060.05627 4131.54436 3060.58241 4131.5085 3061.1181 4131.54436 3061.65379 4131.6513 3062.17993 4131.82741 3062.68712 4132.06956 3063.1663 4132.37341 3063.60894 4132.73355 3064.00713 4133.14355 3064.35376 4133.59609 3064.64265 4134.0831 3064.86865 4134.59589 3065.02772 4135.1253 3065.11702 4135.6619 3065.13496 4136.1961 3065.08122 4136.71836 3064.95676 4136.83511 3064.91179 4136.98556 3064.88512 4137.13503 3064.9168 4137.26172 3065.00222 4141.90494 3069.64545 4141.99165 3069.77522 4142.0221 3069.92829 4142.0221 3093.57263 4141.99553 3093.71597 4141.91936 3093.84028 4141.8037 3093.92903 4141.66391 3093.97044 4141.51857 3093.959 4141.41947 3093.93244 4141.0341 3093.89873 4140.64873 3093.93244 4140.27506 3094.03257 4139.92446 3094.19605 4139.60758 3094.41794 4139.54468 3094.48084 4139.41491 3094.56755 4139.26183 3094.598 4138.68676 3094.598 4138.53266 3094.56712 4138.40235 3094.47926 4138.31594 3094.34798 4138.28679 3094.19354 4138.31938 3094.0398 4138.40868 3093.91047 4138.50838 3093.81405 4138.84112 3093.3927 4139.11473 3092.93076 4139.32432 3092.43647 4139.46617 3091.91865 4139.53773 3091.38655 4139.53773 3090.84965 4139.46617 3090.31755 4139.32432 3089.79973 4139.11473 3089.30544 4138.84112 3088.8435 4138.50838 3088.42215 4138.12245 3088.0489 4137.69021 3087.73043 4137.21938 3087.47241 4136.71836 3087.27944 4136.1961 3087.15498 4135.6619 3087.10124 4135.1253 3087.11918 4134.59589 3087.20848 4134.0831 3087.36755 4133.59609 3087.59355 4133.14355 3087.88244 4132.73355 3088.22907 4132.37341 3088.62726 4132.06956 3089.0699 4131.82741 3089.54908 4131.6513 3090.05627 4131.54436 3090.58241 4131.5085 3091.1181 4131.54436 3091.65379 4131.6513 3092.17993 4131.82741 3092.68712 4132.06956 3093.1663 4132.37341 3093.60894 4132.66351 3093.92969 4132.74247 3094.06049 4132.76662 3094.21137 4132.73245 3094.36029 4132.64492 3094.48553 4132.51683 3094.56882 4132.36685 3094.598 4081.25575 3094.598 4080.93994 3094.6291 4080.65516 3094.71549 4080.39271 3094.85578 4080.1474 3095.05709 4078.20691 3096.99758 4078.08839 3097.07943 4077.94856 3097.11399 4077.80556 3097.09678 4077.40421 3096.97228 4076.8748 3096.88298 4076.3382 3096.86504 4075.804 3096.91878 4075.28174 3097.04324 4074.78072 3097.23621 4074.30989 3097.49423 4073.87765 3097.8127 4073.49172 3098.18595 4073.15898 3098.6073 4072.88537 3099.06924 4072.67578 3099.56353 4072.53393 3100.08135 4072.46237 3100.61345 4072.46237 3101.15035 4072.53393 3101.68245 4072.67578 3102.20027 4072.88537 3102.69456 4073.15898 3103.1565 4073.49172 3103.57785 4073.87765 3103.9511 4074.30989 3104.26957 4074.50815 3104.37822 4074.63926 3104.49353 4074.70876 3104.6537 4074.70341 3104.82822 4074.62423 3104.98383 4074.48631 3105.09089 4074.31591 3105.129 4070.43275 3105.129 4070.11694 3105.1601 4069.83216 3105.24649 4069.56971 3105.38678 4069.3244 3105.58809 4068.30665 3106.60584 4068.17688 3106.69255 Z M 4135.6619 3075.13496 L 4136.1961 3075.08122 4136.71836 3074.95676 4137.21938 3074.76379 4137.69021 3074.50577 4138.12245 3074.1873 4138.50838 3073.81405 4138.84112 3073.3927 4139.11473 3072.93076 4139.32432 3072.43647 4139.46617 3071.91865 4139.53773 3071.38655 4139.53773 3070.84965 4139.46617 3070.31755 4139.32432 3069.79973 4139.11473 3069.30544 4138.84112 3068.8435 4138.50838 3068.42215 4138.12245 3068.0489 4137.69021 3067.73043 4137.21938 3067.47241 4136.71836 3067.27944 4136.1961 3067.15498 4135.6619 3067.10124 4135.1253 3067.11918 4134.59589 3067.20848 4134.0831 3067.36755 4133.59609 3067.59355 4133.14355 3067.88244 4132.73355 3068.22907 4132.37341 3068.62726 4132.06956 3069.0699 4131.82741 3069.54908 4131.6513 3070.05627 4131.54436 3070.58241 4131.5085 3071.1181 4131.54436 3071.65379 4131.6513 3072.17993 4131.82741 3072.68712 4132.06956 3073.1663 4132.37341 3073.60894 4132.73355 3074.00713 4133.14355 3074.35376 4133.59609 3074.64265 4134.0831 3074.86865 4134.59589 3075.02772 4135.1253 3075.11702 4135.6619 3075.13496 Z M 4074.7225 3094.49569 L 4074.7225 3092.6319 4072.8588 3092.6319 4072.88537 3092.69456 4073.15898 3093.1565 4073.49172 3093.57785 4073.87765 3093.9511 4074.30989 3094.26957 4074.7225 3094.49569 Z M 4078.2225 3094.49068 L 4078.40401 3094.40645 4078.85655 3094.11756 4079.26655 3093.77093 4079.62669 3093.37274 4079.93054 3092.9301 4080.08123 3092.6319 4078.2225 3092.6319 4078.2225 3094.49068 Z M 4078.2225 3087.27312 L 4078.2225 3089.1319 4080.08123 3089.1319 4079.93054 3088.8337 4079.62669 3088.39106 4079.26655 3087.99287 4078.85655 3087.64624 4078.40401 3087.35735 4078.2225 3087.27312 Z M 4064.6004 3102.92695 L 4064.6004 3104.49072 4066.2208 3104.49072 4066.2208 3103.96941 4066.19276 3103.72054 4066.11751 3103.50549 4065.99629 3103.31257 4065.83518 3103.15146 4065.64226 3103.03024 4065.42721 3102.95499 4065.17834 3102.92695 4064.6004 3102.92695 Z "}],"B":[{"net":"GND","svgpath":"M 4139.91939 3087.069 L 4139.76632 3087.03855 4139.63655 3086.95184 4137.73141 3085.04671 4137.63921 3084.90294 4137.61539 3084.73381 4137.66428 3084.57017 4137.77698 3084.44184 4138.12245 3084.1873 4138.50838 3083.81405 4138.84112 3083.3927 4139.11473 3082.93076 4139.32432 3082.43647 4139.46617 3081.91865 4139.53773 3081.38655 4139.53773 3080.84965 4139.46617 3080.31755 4139.32432 3079.79973 4139.11473 3079.30544 4138.84112 3078.8435 4138.50838 3078.42215 4138.40848 3078.32553 4138.31917 3078.1962 4138.28658 3078.04246 4138.31574 3077.88802 4138.40214 3077.75674 4138.53245 3077.66888 4138.68655 3077.638 4139.41445 3077.638 4139.73026 3077.6069 4140.01504 3077.52051 4140.27749 3077.38022 4140.5228 3077.17891 4149.18416 3068.51755 4149.31393 3068.43084 4149.467 3068.40039 4149.62007 3068.43084 4149.74984 3068.51755 4149.83655 3068.64732 4149.867 3068.80039 4149.867 3069.10354 4149.89504 3069.35241 4149.97029 3069.56746 4150.09151 3069.76038 4150.25262 3069.92149 4150.44554 3070.04271 4150.66059 3070.11796 4150.90946 3070.146 4164.08 3070.146 4164.23307 3070.17645 4164.36284 3070.26316 4164.44955 3070.39293 4164.48 3070.546 4164.48 3071.813 4164.44955 3071.96607 4164.36284 3072.09584 4164.23307 3072.18255 4164.08 3072.213 4159.70025 3072.213 4159.70025 3072.885 4164.08 3072.885 4164.23307 3072.91545 4164.36284 3073.00216 4164.44955 3073.13193 4164.48 3073.285 4164.48 3079.875 4164.44955 3080.02807 4164.36284 3080.15784 4164.23307 3080.24455 4164.08 3080.275 4159.70025 3080.275 4159.70025 3080.946 4164.08 3080.946 4164.23307 3080.97645 4164.36284 3081.06316 4164.44955 3081.19293 4164.48 3081.346 4164.48 3082.613 4164.44955 3082.76607 4164.36284 3082.89584 4164.23307 3082.98255 4164.08 3083.013 4151.58068 3083.013 4151.43734 3082.98643 4151.31303 3082.91026 4151.22428 3082.7946 4151.18287 3082.65481 4151.19431 3082.50947 4151.23266 3082.36637 4151.26637 3081.981 4151.23266 3081.59563 4151.19351 3081.44953 4151.18207 3081.30419 4151.22348 3081.1644 4151.31223 3081.04874 4151.43653 3080.97257 4151.57988 3080.946 4155.85375 3080.946 4155.85375 3080.275 4150.59126 3080.275 4150.47098 3080.25649 4150.36183 3080.20266 4150.15674 3080.05905 4149.80614 3079.89557 4149.43247 3079.79544 4149.0471 3079.76173 4148.66173 3079.79544 4148.28806 3079.89557 4147.93746 3080.05905 4147.62058 3080.28094 4147.34704 3080.55448 4147.12515 3080.87136 4146.96167 3081.22196 4146.86154 3081.59563 4146.83384 3081.91231 4146.79788 3082.0465 4146.7182 3082.16029 4141.92665 3086.95184 4141.79688 3087.03855 4141.64381 3087.069 4139.91939 3087.069 Z M 4155.85375 3072.885 L 4155.85375 3072.213 4150.90946 3072.213 4150.66059 3072.24104 4150.44554 3072.31629 4150.25262 3072.43751 4150.09151 3072.59862 4149.97029 3072.79154 4149.93759 3072.885 4155.85375 3072.885 Z "},{"net":"GND","svgpath":"M 4080.27871 3103.528 L 4080.1201 3103.49521 4079.98749 3103.40221 4079.90263 3103.26425 4079.87944 3103.10395 4079.9217 3102.9476 4080.17269 3102.45092 4080.3488 3101.94373 4080.45574 3101.41759 4080.4916 3100.8819 4080.45574 3100.34621 4080.3488 3099.82007 4080.17269 3099.31288 4079.93054 3098.8337 4079.62669 3098.39106 4079.26655 3097.99287 4078.85655 3097.64624 4078.40401 3097.35735 4078.11739 3097.22434 4077.98384 3097.12388 4077.90299 3096.97762 4077.87461 3096.88406 4077.73432 3096.62161 4077.53301 3096.3763 4074.83966 3093.68295 4074.75295 3093.55318 4074.7225 3093.40011 4074.7225 3092.6319 4073.95429 3092.6319 4073.80122 3092.60145 4073.67145 3092.51474 4063.86526 3082.70855 4063.77855 3082.57878 4063.7481 3082.42571 4063.7481 3076.73965 4063.717 3076.42384 4063.63061 3076.13906 4063.49032 3075.87661 4063.30153 3075.64657 4063.07149 3075.45778 4062.80904 3075.31749 4062.35316 3075.18732 4062.23662 3075.09865 4062.1598 3074.97399 4062.133 3074.83003 4062.133 3073.39646 4062.10496 3073.14759 4062.02971 3072.93254 4061.90849 3072.73962 4061.74738 3072.57851 4061.55446 3072.45729 4061.33941 3072.38204 4061.09054 3072.354 4048.98 3072.354 4048.82693 3072.32355 4048.69716 3072.23684 4048.61045 3072.10707 4048.58 3071.954 4048.58 3070.687 4048.61045 3070.53393 4048.69716 3070.40416 4048.82693 3070.31745 4048.98 3070.287 4061.09054 3070.287 4061.33941 3070.25896 4061.55446 3070.18371 4061.74738 3070.06249 4061.90849 3069.90138 4062.02971 3069.70846 4062.10496 3069.49341 4062.133 3069.24454 4062.133 3062.59646 4062.10496 3062.34759 4062.02971 3062.13254 4061.90849 3061.93962 4061.74738 3061.77851 4061.55446 3061.65729 4061.33941 3061.58204 4061.09054 3061.554 4048.98 3061.554 4048.82693 3061.52355 4048.69716 3061.43684 4048.61045 3061.30707 4048.58 3061.154 4048.58 3059.887 4048.61045 3059.73393 4048.69716 3059.60416 4048.82693 3059.51745 4048.98 3059.487 4052.29975 3059.487 4052.29975 3058.815 4048.98 3058.815 4048.82693 3058.78455 4048.69716 3058.69784 4048.61045 3058.56807 4048.58 3058.415 4048.58 3051.825 4048.61045 3051.67193 4048.69716 3051.54216 4048.82693 3051.45545 4048.98 3051.425 4052.29975 3051.425 4052.29975 3050.754 4048.98 3050.754 4048.82693 3050.72355 4048.69716 3050.63684 4048.61045 3050.50707 4048.58 3050.354 4048.58 3027.92 4048.61045 3027.76693 4048.69716 3027.63716 4048.82693 3027.55045 4048.98 3027.52 4073.19205 3027.52 4073.36526 3027.55945 4073.50431 3027.67001 4073.58177 3027.82987 4073.58236 3028.00752 4073.50597 3028.1679 4073.15898 3028.6073 4072.88537 3029.06924 4072.67578 3029.56353 4072.53393 3030.08135 4072.46237 3030.61345 4072.46237 3031.15035 4072.53389 3031.68211 4072.68564 3032.23244 4072.69868 3032.37171 4072.66297 3032.50695 4072.58288 3032.62162 4071.29019 3033.9143 4071.08888 3034.15961 4070.94859 3034.42206 4070.8622 3034.70684 4070.8311 3035.02265 4070.8311 3073.99273 4070.80065 3074.14581 4070.71394 3074.27558 4070.65104 3074.33848 4070.42915 3074.65536 4070.26567 3075.00596 4070.16554 3075.37963 4070.13183 3075.765 4070.16554 3076.15037 4070.26567 3076.52404 4070.42915 3076.87464 4070.65104 3077.19152 4070.92458 3077.46506 4071.24146 3077.68695 4071.59206 3077.85043 4071.96573 3077.95056 4072.3511 3077.98427 4072.73647 3077.95056 4072.9307 3077.93397 4073.08542 3077.99282 4073.20306 3078.10927 4073.26348 3078.26338 4073.25634 3078.42875 4073.15898 3078.6073 4072.88537 3079.06924 4072.67578 3079.56353 4072.53393 3080.08135 4072.46237 3080.61345 4072.46237 3081.15035 4072.53393 3081.68245 4072.67578 3082.20027 4072.88537 3082.69456 4073.15898 3083.1565 4073.49172 3083.57785 4073.87765 3083.9511 4074.30989 3084.26957 4074.78072 3084.52759 4075.28174 3084.72056 4075.804 3084.84502 4076.3382 3084.89876 4076.8748 3084.88082 4077.40421 3084.79152 4077.917 3084.63245 4078.40401 3084.40645 4078.85655 3084.11756 4079.26655 3083.77093 4079.62669 3083.37274 4079.93054 3082.9301 4080.17269 3082.45092 4080.3488 3081.94373 4080.45574 3081.41759 4080.4916 3080.8819 4080.45574 3080.34621 4080.3488 3079.82007 4080.17269 3079.31288 4079.93054 3078.8337 4079.62669 3078.39106 4079.26655 3077.99287 4078.85655 3077.64624 4078.40401 3077.35735 4077.917 3077.13135 4077.40421 3076.97228 4076.8748 3076.88298 4076.3382 3076.86504 4075.804 3076.91878 4075.28174 3077.04324 4074.88176 3077.19729 4074.72674 3077.22386 4074.57345 3077.18861 4074.44561 3077.09698 4074.36298 3076.96315 4074.33833 3076.80781 4074.37548 3076.65497 4074.43653 3076.52404 4074.53666 3076.15037 4074.57037 3075.765 4074.53666 3075.37963 4074.45746 3075.08407 4074.45017 3074.90962 4074.51788 3074.74868 4074.6477 3074.63193 4074.81489 3074.58159 4074.9876 3074.60727 4075.28174 3074.72056 4075.804 3074.84502 4076.3382 3074.89876 4076.8748 3074.88082 4077.40421 3074.79152 4077.917 3074.63245 4078.40401 3074.40645 4078.85655 3074.11756 4079.26655 3073.77093 4079.62669 3073.37274 4079.93054 3072.9301 4080.08644 3072.6216 4080.17513 3072.50534 4080.29968 3072.42873 4080.44345 3072.402 4080.80945 3072.402 4081.12526 3072.3709 4081.41004 3072.28451 4081.67249 3072.14422 4081.9178 3071.94291 4104.61381 3049.2469 4104.7276 3049.16722 4104.86179 3049.13126 4105.17847 3049.10356 4105.55214 3049.00343 4105.90274 3048.83995 4106.21962 3048.61806 4106.49316 3048.34452 4106.71505 3048.02764 4106.87853 3047.67704 4106.97866 3047.30337 4107.01237 3046.918 4106.97866 3046.53263 4106.87853 3046.15896 4106.71505 3045.80836 4106.49316 3045.49148 4106.21962 3045.21794 4105.90274 3044.99605 4105.55214 3044.83257 4105.17847 3044.73244 4104.7931 3044.69873 4104.40773 3044.73244 4104.03406 3044.83257 4103.68346 3044.99605 4103.36658 3045.21794 4103.09304 3045.49148 4102.87115 3045.80836 4102.70767 3046.15896 4102.60754 3046.53263 4102.57984 3046.84931 4102.54388 3046.9835 4102.4642 3047.09729 4095.52107 3054.04043 4095.38157 3054.13102 4095.21729 3054.15704 4095.05663 3054.11399 4094.92736 3054.00932 4094.85185 3053.86112 4094.82153 3053.74796 4094.65805 3053.39736 4094.43616 3053.08048 4094.16262 3052.80694 4093.84574 3052.58505 4093.49514 3052.42157 4093.12147 3052.32144 4092.7361 3052.28773 4092.35073 3052.32144 4091.97706 3052.42157 4091.62646 3052.58505 4091.30958 3052.80694 4091.24668 3052.86984 4091.11691 3052.95655 4090.96383 3052.987 4081.38839 3052.987 4081.23532 3052.95655 4081.10555 3052.86984 4080.47214 3052.23643 4080.39598 3052.13 4080.35826 3052.00469 4080.36299 3051.87391 4080.45574 3051.41759 4080.4916 3050.8819 4080.45574 3050.34621 4080.3488 3049.82007 4080.17269 3049.31288 4079.93054 3048.8337 4079.62669 3048.39106 4079.26655 3047.99287 4078.85655 3047.64624 4078.40401 3047.35735 4077.917 3047.13135 4077.40421 3046.97228 4076.8748 3046.88298 4076.3382 3046.86504 4075.804 3046.91878 4075.28174 3047.04324 4074.78072 3047.23621 4074.46333 3047.41014 4074.30581 3047.45785 4074.14242 3047.4381 4074.00081 3047.35422 4073.90496 3047.22042 4073.8711 3047.05936 4073.8711 3044.70444 4073.90496 3044.54338 4074.00081 3044.40958 4074.14242 3044.3257 4074.30581 3044.30595 4074.46333 3044.35366 4074.78072 3044.52759 4075.28174 3044.72056 4075.804 3044.84502 4076.3382 3044.89876 4076.8748 3044.88082 4077.40421 3044.79152 4077.917 3044.63245 4078.40401 3044.40645 4078.85655 3044.11756 4079.26655 3043.77093 4079.62669 3043.37274 4079.93054 3042.9301 4080.17269 3042.45092 4080.3488 3041.94373 4080.45574 3041.41759 4080.4916 3040.8819 4080.45574 3040.34621 4080.3488 3039.82007 4080.17269 3039.31288 4079.93054 3038.8337 4079.62669 3038.39106 4079.26655 3037.99287 4078.85655 3037.64624 4078.40401 3037.35735 4077.917 3037.13135 4077.40421 3036.97228 4076.8748 3036.88298 4076.3382 3036.86504 4075.804 3036.91878 4075.28174 3037.04324 4074.78072 3037.23621 4074.46333 3037.41014 4074.30581 3037.45785 4074.14242 3037.4381 4074.00081 3037.35422 4073.90496 3037.22042 4073.8711 3037.05936 4073.8711 3035.79829 4073.90155 3035.64522 4073.98826 3035.51545 4074.73788 3034.76583 4074.86456 3034.68041 4075.01404 3034.64873 4075.16448 3034.6754 4075.28174 3034.72056 4075.804 3034.84502 4076.3382 3034.89876 4076.8748 3034.88082 4077.40421 3034.79152 4077.917 3034.63245 4078.40401 3034.40645 4078.85655 3034.11756 4079.26655 3033.77093 4079.62669 3033.37274 4079.93054 3032.9301 4080.17269 3032.45092 4080.3488 3031.94373 4080.45574 3031.41759 4080.4916 3030.8819 4080.45574 3030.34621 4080.3488 3029.82007 4080.17269 3029.31288 4079.93054 3028.8337 4079.62669 3028.39106 4079.44332 3028.18831 4079.36436 3028.05751 4079.3402 3027.90663 4079.37438 3027.75771 4079.4619 3027.63247 4079.59 3027.54918 4079.73998 3027.52 4132.47957 3027.52 4132.63777 3027.55262 4132.77018 3027.64514 4132.85519 3027.78249 4132.87895 3027.94227 4132.83758 3028.09841 4132.73355 3028.22907 4132.37341 3028.62726 4132.06956 3029.0699 4131.91887 3029.3681 4133.7776 3029.3681 4133.7776 3027.92 4133.80805 3027.76693 4133.89476 3027.63716 4134.02453 3027.55045 4134.1776 3027.52 4136.8776 3027.52 4137.03067 3027.55045 4137.16044 3027.63716 4137.24715 3027.76693 4137.2776 3027.92 4137.2776 3029.3681 4139.1413 3029.3681 4139.11473 3029.30544 4138.84112 3028.8435 4138.50838 3028.42215 4138.28647 3028.20753 4138.19716 3028.0782 4138.16457 3027.92446 4138.19372 3027.77002 4138.28013 3027.63874 4138.41044 3027.55088 4138.56454 3027.52 4164.08 3027.52 4164.23307 3027.55045 4164.36284 3027.63716 4164.44955 3027.76693 4164.48 3027.92 4164.48 3050.214 4164.44955 3050.36707 4164.36284 3050.49684 4164.23307 3050.58355 4164.08 3050.614 4150.90946 3050.614 4150.66059 3050.64204 4150.44554 3050.71729 4150.25262 3050.83851 4150.09151 3050.99962 4149.97029 3051.19254 4149.89504 3051.40759 4149.867 3051.65646 4149.867 3053.09005 4149.8402 3053.23401 4149.76338 3053.35867 4149.64684 3053.44734 4149.47594 3053.4911 4149.19116 3053.57749 4148.92871 3053.71778 4148.6834 3053.91909 4147.81465 3054.78784 4147.68488 3054.87455 4147.53181 3054.905 4138.36559 3054.905 4138.21123 3054.87401 4138.08078 3054.78586 4137.99445 3054.65419 4137.96563 3054.49941 4137.99877 3054.34549 4138.08874 3054.21629 4138.50891 3053.81338 4138.84112 3053.3927 4139.11473 3052.93076 4139.32432 3052.43647 4139.46617 3051.91865 4139.53773 3051.38655 4139.53773 3050.84965 4139.46617 3050.31755 4139.32432 3049.79973 4139.11473 3049.30544 4138.84112 3048.8435 4138.50838 3048.42215 4138.12245 3048.0489 4137.69021 3047.73043 4137.21938 3047.47241 4136.71836 3047.27944 4136.1961 3047.15498 4135.6619 3047.10124 4135.1253 3047.11918 4134.59589 3047.20848 4134.0831 3047.36755 4133.59609 3047.59355 4133.14355 3047.88244 4132.73355 3048.22907 4132.37341 3048.62726 4132.06956 3049.0699 4131.82741 3049.54908 4131.6513 3050.05627 4131.54436 3050.58241 4131.5085 3051.1181 4131.54436 3051.65379 4131.6513 3052.17993 4131.82741 3052.68712 4132.06956 3053.1663 4132.37341 3053.60894 4132.73355 3054.00713 4133.03857 3054.26501 4133.14224 3054.40013 4133.1803 3054.56612 4133.14585 3054.73291 4133.04515 3054.87025 4132.89643 3054.95325 4132.66816 3055.02249 4132.40571 3055.16278 4132.1604 3055.36409 4084.11365 3103.41084 4083.98388 3103.49755 4083.83081 3103.528 4080.27871 3103.528 Z M 4135.6619 3045.13496 L 4136.1961 3045.08122 4136.71836 3044.95676 4137.21938 3044.76379 4137.69021 3044.50577 4138.12245 3044.1873 4138.50838 3043.81405 4138.84112 3043.3927 4139.11473 3042.93076 4139.32432 3042.43647 4139.46617 3041.91865 4139.53773 3041.38655 4139.53773 3040.84965 4139.46617 3040.31755 4139.32432 3039.79973 4139.11473 3039.30544 4138.84112 3038.8435 4138.50838 3038.42215 4138.12245 3038.0489 4137.69021 3037.73043 4137.21938 3037.47241 4136.71836 3037.27944 4136.1961 3037.15498 4135.6619 3037.10124 4135.1253 3037.11918 4134.59589 3037.20848 4134.0831 3037.36755 4133.59609 3037.59355 4133.14355 3037.88244 4132.73355 3038.22907 4132.37341 3038.62726 4132.06956 3039.0699 4131.82741 3039.54908 4131.6513 3040.05627 4131.54436 3040.58241 4131.5085 3041.1181 4131.54436 3041.65379 4131.6513 3042.17993 4131.82741 3042.68712 4132.06956 3043.1663 4132.37341 3043.60894 4132.73355 3044.00713 4133.14355 3044.35376 4133.59609 3044.64265 4134.0831 3044.86865 4134.59589 3045.02772 4135.1253 3045.11702 4135.6619 3045.13496 Z M 4061.09054 3059.487 L 4061.33941 3059.45896 4061.55446 3059.38371 4061.74738 3059.26249 4061.90849 3059.10138 4062.02971 3058.90846 4062.06241 3058.815 4056.14625 3058.815 4056.14625 3059.487 4061.09054 3059.487 Z M 4062.06206 3051.425 L 4062.02971 3051.33254 4061.90849 3051.13962 4061.74738 3050.97851 4061.55446 3050.85729 4061.33941 3050.78204 4061.09054 3050.754 4056.14625 3050.754 4056.14625 3051.425 4062.06206 3051.425 Z M 4137.2776 3034.73189 L 4137.69021 3034.50577 4138.12245 3034.1873 4138.50838 3033.81405 4138.84112 3033.3927 4139.11473 3032.93076 4139.1413 3032.8681 4137.2776 3032.8681 4137.2776 3034.73189 Z M 4072.88537 3089.06924 L 4072.8588 3089.1319 4074.7225 3089.1319 4074.7225 3087.26811 4074.30989 3087.49423 4073.87765 3087.8127 4073.49172 3088.18595 4073.15898 3088.6073 4072.88537 3089.06924 Z M 4078.2225 3087.27312 L 4078.2225 3089.1319 4080.08123 3089.1319 4079.93054 3088.8337 4079.62669 3088.39106 4079.26655 3087.99287 4078.85655 3087.64624 4078.40401 3087.35735 4078.2225 3087.27312 Z M 4078.2225 3092.6319 L 4078.2225 3094.49068 4078.40401 3094.40645 4078.85655 3094.11756 4079.26655 3093.77093 4079.62669 3093.37274 4079.93054 3092.9301 4080.08123 3092.6319 4078.2225 3092.6319 Z M 4133.7776 3034.72688 L 4133.7776 3032.8681 4131.91887 3032.8681 4132.06956 3033.1663 4132.37341 3033.60894 4132.73355 3034.00713 4133.14355 3034.35376 4133.59609 3034.64265 4133.7776 3034.72688 Z "}]},"pads":[],"nets":["GND","DSR","CTS","RTS","RXD","TXD","VCC-IN","LED1_1","FUSE1_1","VCC","DCD","DTR"],"bom":{"both":[[1,"PPTC0.5A/24V -0603","F0603",[["FUSE1",0]],[" "," "," "," "]],[1,"LED0603","LED0603-RD",[["LED1",1]],[" "," "," "," "]],[1,"1N5819WS","SOD-323_L1.8-W1.3-LS2.5-RD",[["D1",2]],[" "," "," "," "]],[1,"20k","R0603",[["R1",3]],[" "," "," "," "]],[2,"DB9-FEMALE-MSX","DB9-FEMALE-MSX",[["P1",4],["P2",5]],[" "," "," "," "]],[1,"FT232RL USB to TTL Module","FT232RL USB TO TTL MODULE",[["U1",6]],[" "," "," "," "]]],"F":[[1,"PPTC0.5A/24V -0603","F0603",[["FUSE1",0]],[" "," "," "," "]],[1,"LED0603","LED0603-RD",[["LED1",1]],[" "," "," "," "]],[1,"1N5819WS","SOD-323_L1.8-W1.3-LS2.5-RD",[["D1",2]],[" "," "," "," "]],[1,"20k","R0603",[["R1",3]],[" "," "," "," "]],[2,"DB9-FEMALE-MSX","DB9-FEMALE-MSX",[["P1",4],["P2",5]],[" "," "," "," "]],[1,"FT232RL USB to TTL Module","FT232RL USB TO TTL MODULE",[["U1",6]],[" "," "," "," "]]],"B":[],"skipped":[],"customColumns":[]}};
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'ibom__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';

function buildKeyForLocalStorageDict() {  
  return storagePrefix;
}

var storage;
var _isLocalStorageUsed = false;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;    
    _isLocalStorageUsed = true;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;      
    } catch (e) {
      // sessionStorage also not available
    }
  }
}



function readStorage(key) {
  if(!storage) {
    return null;
  }

  if(!_isLocalStorageUsed) {    
    return storage.getItem(storagePrefix + key);
  }

  try {
    var dictKey = buildKeyForLocalStorageDict();
    var obj = JSON.parse(storage.getItem(dictKey));    
    if(!obj || !obj.hasOwnProperty(key)) {
      return null;
    }

    return JSON.parse(storage.getItem(dictKey))[key];
  } catch(e) {
    console.log('[ibom]: Unable to obtain a value from local storage!');
    console.log(e);
  }
  
  // Original implementation
  // return storage.getItem(storagePrefix + key);
}


function writeStorage(key, value) {
  if(!storage) {
    return;
  }

  if(!_isLocalStorageUsed) {
    storage.setItem(storagePrefix + key, value);
    return;
  }

  try {
    var dictKey = buildKeyForLocalStorageDict();
    if(!storage.getItem(dictKey)) {
      storage.setItem(dictKey,JSON.stringify({
        _storagePrefix: storagePrefix
      }));
    }

    var obj = JSON.parse(storage.getItem(dictKey));
    obj[key] = value;
    storage.setItem(dictKey,JSON.stringify(obj));            
  } catch(e) {
    console.log('[ibom]: Unable to write key to local storage!');
    console.log(e);
  }
  
  // Original implementation
  // storage.setItem(storagePrefix + key, value);
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function() {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function() {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function copyToClipboard() {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      text = text + node.firstChild.nodeValue;
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += '\t';
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            text = text + '';
          }
        } else if (node.nodeName == "MARK") {
          text = text + node.firstChild.nodeValue;
        } else {
          text = text + node.nodeValue;
        }
      }
      if (cell != row.lastChild) {
        text += '\t';
      }
    }
    text += '\n';
  }
  var textArea = document.createElement("textarea");
  textArea.classList.add('clipboard-temp');
  textArea.value = text;

  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    if (document.execCommand('copy')) {
      console.log('Bom copied to clipboard.');
    }
  } catch (err) {
    console.log('Can not copy to clipboard.');
  }

  document.body.removeChild(textArea);
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function(s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
                    .concat(units.prefixes.mega)
                    .concat(units.prefixes.kilo)
                    .concat(units.prefixes.milli)
                    .concat(units.prefixes.micro)
                    .concat(units.prefixes.nano)
                    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
                         "\\s*(" + allPrefixes.join("|") + ")?" +
                         "(" + allUnits.join("|") + ")?" +
                         "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
                         "(" + units.unitsShort.join("|") + ")?" +
                         "([GgMmKkUuNnPp])?" +
                         "([0-9]*)" +
                         "(\\b.*)?$", "");
  for (var bom_type of ["both", "F", "B"]) {
    for (var row of pcbdata.bom[bom_type]) {
      row.push(parseValue(row[1], row[3][0][0]));
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      unit = unit[0];
    } else {
      ref = /^([a-z]+)\d+$/i.exec(ref);
      if (ref) {
        ref = ref[1].toLowerCase();
        if (ref == "c") unit = 'f';
        else if (ref == "l") unit = 'h';
        else if (ref == "r" || ref == "rv") unit = 'r';
        else unit = null;
      }
    }
    return unit;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  var unit;
  if (match) {
    val = parseFloat(match[1]);
    if (match[2]) {
      val = val * units.getMultiplier(match[2]);
    }
    unit = inferUnit(match[3], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[4],
    }
  }
  match = units.valueAltRegex.exec(val);
  if (match && (match[1] || match[4])) {
    val = parseFloat(match[1] + "." + match[4]);
    if (match[3]) {
      val = val * units.getMultiplier(match[3]);
    }
    unit = inferUnit(match[2], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {type: "application/json"});
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function(e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch(e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
          `Settins file metadata does not match current metadata.\n\n` +
          `Page metadata:\n${currentMetadata}\n\n` +
          `Settings file metadata:\n${fileMetadata}\n\n` +
          `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function overwriteSettings(newSettings) {

  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("darkenWhenChecked", settings.darkenWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setShowCrosshair(settings.showCrosshair);
  document.getElementById("crosshairCheckbox").checked = settings.showCrosshair;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.getElementById("highlightpin1Checkbox").checked = settings.highlightpin1;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
      bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
  while(n--){
      u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {type:mime});
}

var settings = {
  canvaslayout: "default",
  bomlayout: "default",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: false,
  redrawOnDrag: true,
  boardRotation: 0,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  settings.darkenWhenChecked = readStorage("darkenWhenChecked") || "";
  populateDarkenWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {    
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b === true);
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", false, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("showCrosshair", config.show_crosshair, "crosshairCheckbox", setShowCrosshair);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);
  initBooleanSetting("highlightpin1", config.highlight_pin1, "highlightpin1Checkbox", setHighlightPin1);
  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function() {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function(eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function(eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for(callback of this.callbacks[eventType])
      callback(event);
    for(callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");
var hitTestContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.lineWidth = text.thickness;

  if ("svgpath" in text) {    
    // TODO: This path must be cached!
    const path = new Path2D(text.svgpath);
    if(text.useTrueTypeFontRendering) {            
      ctx.fill(path);
    } else {
      ctx.stroke(path);
    }
    
    ctx.restore();
    return;
  }

  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        offsetx += fourSpaces - offsetx % fourSpaces;
        continue;
      } else if (txt[i][j] == '~') {
        j++;
        if (j == txt[i].length)
          break;
        if (txt[i][j] != '~') {
          inOverbar = !inOverbar;
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, shape, color) {
  ctx.save();
  ctx.fillStyle = color;
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  ctx.fill(getPolygonsPath(shape));
  ctx.restore();
}


function drawPolylineShape(ctx, shape, color) {
  ctx.save();
  ctx.strokeStyle = color;
  ctx.lineWidth = shape.width;
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  ctx.stroke(getPolygonsPath(shape));
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {  
  if (["segment", "arc", "circle", "curve"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, drawing, color);
  } else if (drawing.type == "text") {    
    drawText(ctx, drawing, color);
  } else if (drawing.type == "polyline") {    
    drawPolylineShape(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    } else if(pad.shape === "polygon") {      
      pad.path2d = new Path2D();
      if(pad.polygon.length > 1) {
        const pos = {
          x: pad.pos[0],
          y: pad.pos[1]
        };

        pad.path2d.moveTo(pad.polygon[0].x - pos.x, pad.polygon[0].y - pos.y);
        for (var i = 1; i < pad.polygon.length; i++) {
          const point = pad.polygon[i];          
          pad.path2d.lineTo(point.x - pos.x, point.y - pos.y);
        }
        pad.path2d.closePath();              
      }
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  if(pad.shape !== 'polygon') {
    ctx.rotate(deg2rad(pad.angle));  
  } else {
    ctx.rotate(deg2rad(0));  
  }
  
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") {
    return
  };

  ctx.save();
  ctx.translate(pad.holeCenterPoint.x, pad.holeCenterPoint.y);    
  ctx.rotate(deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, padColor, padHoleColor, outlineColor, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = padColor;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = padColor;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, padColor);
    }
  }
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, padColor, outline);
        if (pad.pin1 && settings.highlightpin1) {
          drawPad(ctx, pad, outlineColor, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, padHoleColor);
    }
  }
}

function drawCrosshair(canvas, x, y, scalefactor, color) {
  if(!settings.showCrosshair) {
    return;
  }

  var ctx = canvas.getContext("2d");

  HTMLFormControlsCollection.log
  
  ctx.save();
  ctx.globalAlpha = 0.75;
  ctx.lineWidth = 2 / scalefactor;
  ctx.strokeStyle = color;

  // TODO: Should calculate a proper bbox for the view port.
  const dummyOffset = 4000;

  // horz line
  ctx.beginPath();
  ctx.moveTo(x - dummyOffset, y);
  ctx.lineTo(x + dummyOffset, y);
  ctx.stroke();

  // vert line
  ctx.beginPath();
  ctx.moveTo(x, y - dummyOffset);
  ctx.lineTo(x, y + dummyOffset);
  ctx.stroke();

  ctx.globalAlpha = 1;
  ctx.restore();
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawedge(ctx, scalefactor, edge, edgecolor);
  }
}

function drawOrphanPads(canvas, layer, scalefactor, highlight, highlightedPads) {
  if (!settings.renderPads) {
    return;
  }

  highlightedPads = highlightedPads || [];

  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);
  var padColor = style.getPropertyValue('--pad-color');
  var padHoleColor = style.getPropertyValue('--pad-hole-color');  
  if (highlight) {
    padColor = style.getPropertyValue('--pad-color-highlight');
    outlineColor = style.getPropertyValue('--pin1-outline-color-highlight');
  }

  var i = 0;
  for (var pad of pcbdata.pads) {
    if (pad.layers.includes(layer)) {
      var outline = settings.renderDnpOutline;
      if (!highlight || highlightedPads.includes(i)) {
        drawPad(ctx, pad, padColor, outline); 
      }     
    }

    i++;
  }
  
  for (var pad of pcbdata.pads) {
    drawPadHole(ctx, pad, padHoleColor);
  }  

  ctx.restore();
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);
  var padColor = style.getPropertyValue('--pad-color');
  var padHoleColor = style.getPropertyValue('--pad-hole-color');
  var outlineColor = style.getPropertyValue('--pin1-outline-color');
  if (highlight) {
    padColor = style.getPropertyValue('--pad-color-highlight');
    outlineColor = style.getPropertyValue('--pin1-outline-color-highlight');
  }
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    if (!highlight || highlightedFootprints.includes(i)) {
      drawFootprint(ctx, layer, scalefactor, mod, padColor, padHoleColor, outlineColor, highlight, outline);
    }
  }
  ctx.restore();
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect","polyline"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, d, polygonColor);
    } else if (d.type == "text") {
      drawText(ctx, d, polygonColor);
    }
  }
}

function drawTracks(canvas, layer, color, highlight) {
  ctx = canvas.getContext("2d");
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  for(var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    ctx.lineWidth = track.width;

    if(track.type === 'polyline') {
      drawPolylineShape(ctx,track,color);
    } else if(track.type === 'polygon') {
      drawPolygonShape(ctx, track, color);
    } else if(track.type === 'text') {
      drawText(ctx, track, color);
    } else {
      if ('radius' in track) {
        ctx.beginPath();
        ctx.arc(
            ...track.center,
            track.radius,
            deg2rad(track.startangle),
            deg2rad(track.endangle));
        ctx.stroke();
      } else if('start' in track && 'end' in track) {
        ctx.beginPath();
        ctx.moveTo(...track.start);
        ctx.lineTo(...track.end);
        ctx.stroke();
      }
      
    }

  }
}

function drawZones(canvas, layer, color, highlight) {
  ctx = canvas.getContext("2d");
  ctx.save();
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineJoin = "round";
  for(var zone of pcbdata.zones[layer]) {
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    if (highlight && highlightedNet != zone.net) continue;
    ctx.fill(zone.path2d);
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
  ctx.restore();
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  
  if (highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }

  // Draw crosshairs
  if (highlightedFootprints.length > 0) {
    for(var i = 0; i < pcbdata.footprints.length; i++) {
      const footprint = pcbdata.footprints[i];
      if(highlightedFootprints.includes(i) && footprint.layer === canvasdict.layer) {
        drawCrosshair(canvasdict.highlight, footprint.center[0], footprint.center[1], canvasdict.transform.s * canvasdict.transform.zoom, 'red');
      }
    }
  }

  if (highlightedNet !== null) {
    var highlightedPads = [];
    for(var i = 0; i < pcbdata.pads.length; i++) {
      var pad = pcbdata.pads[i];
      if(pad.net === highlightedNet) {
        highlightedPads.push(i);
      }
    }
    
    drawOrphanPads(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true, highlightedPads);

    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);

  drawOrphanPads(canvasdict.bg, canvasdict.layer, canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawFootprints(canvasdict.bg, canvasdict.layer, canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  var fontsize = 1.55;
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer == "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var bbox = applyRotation(pcbdata.edges_bbox);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  var flip = (layerdict.layer == "B");
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod ) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius-d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, -pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // TODO: Should be refactored

  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for(var track of pcbdata.tracks[layer]) {
      if(track.type === 'polyline') {
        const path = getPolygonsPath(track);
        if(path) {
          hitTestContext2d.save();
          hitTestContext2d.lineWidth = track.width;
          
          if(hitTestContext2d.isPointInStroke(path,x,y)) {
            hitTestContext2d.restore();
            return track.net;            
          }
          
          hitTestContext2d.restore();          
        }        

      } else if(track.type === 'polygon') {
        const path = getPolygonsPath(track);
        if(path && hitTestContext2d.isPointInPath(path,x,y)) {          
          return track.net;                      
        }                     
      } else if(track.type === 'text') {
        // TODO: To implement taking in account TrueType fonts.
      } else if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else if('start' in track && 'end' in track) {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {

    // Footprints containing pads
    for (var footprint of pcbdata.footprints) {
      for(var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }

    // Orphan pads
    for(var pad of pcbdata.pads) {
      if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
        return pad.net;
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
         bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  if (layerdict.layer == "B") {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation);
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2)     + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist/oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setShowCrosshair(value) {
  settings.showCrosshair = value;
  writeStorage("showCrosshair", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var highlightedFootprints = [];
var highlightedOrphanPads = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
}

function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxChangeHandler(checkbox, references, row) {
  return function() {
    refsSet = getStoredCheckboxRefs(checkbox);
    var darkenWhenChecked = settings.darkenWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (this.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (darkenWhenChecked) {
        row.classList.add("checked");
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (darkenWhenChecked) {
        row.classList.remove("checked");
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];  
    highlightedOrphanPads = [];  
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function() {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT,
      {
        rowid: rowid,
        refs: refs,
        net: net
      });
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  for (var ref of entry[3]) {
    if (ref[0].toLowerCase().indexOf(filter) >= 0) {
      return true;
    }
  }
  // check extra fields
  for (var i in config.extra_fields) {
    if (entry[4][i].toLowerCase().indexOf(filter) >= 0) {
      return true;
    }
  }
  // check value
  if (entry[1].toLowerCase().indexOf(filter) >= 0) {
    return true;
  }
  // check footprint
  if (entry[2].toLowerCase().indexOf(filter) >= 0) {
    return true;
  }
  return false;
}

function findRefInEntry(entry) {
  return entry[3].filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function() {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  th.style.cursor = "pointer";
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  th.onclick = function() {
    if (currentSortColumn && this !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && this === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function(a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = this;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  return th;
}

function populateBomHeader() {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");
  tr.appendChild(th);
  var checkboxCompareClosure = function(checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a[3]);
      var stateB = getCheckboxState(checkbox, b[3]);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    th = createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    });
    tr.appendChild(th);
  } else {
    for (var checkbox of settings.checkboxes) {
      th = createColumnHeader(
        checkbox, "bom-checkbox", checkboxCompareClosure(checkbox));
      th.onclick = fancyDblClickHandler(
        th, th.onclick.bind(th), checkboxSetUnsetAllHandler(checkbox));
      tr.appendChild(th);
    }
    tr.appendChild(createColumnHeader("References", "References", (a, b) => {
      var i = 0;
      while (i < a[3].length && i < b[3].length) {
        if (a[3][i] != b[3][i]) return a[3][i] > b[3][i] ? 1 : -1;
        i++;
      }
      return a[3].length - b[3].length;
    }));
    // Extra fields
    if (config.extra_fields.length > 0) {
      var extraFieldCompareClosure = function(fieldIndex) {
        return (a, b) => {
          var fa = a[4][fieldIndex];
          var fb = b[4][fieldIndex];
          if (fa != fb) return fa > fb ? 1 : -1;
          else return 0;
        }
      }
      for (var i in config.extra_fields) {
        tr.appendChild(createColumnHeader(
          config.extra_fields[i], "extra", extraFieldCompareClosure(i)));
      }
    }
    tr.appendChild(createColumnHeader("Value", "Value", (a, b) => {
      return valueCompare(a[5], b[5], a[1], b[1]);
    }));
    tr.appendChild(createColumnHeader("Footprint", "Footprint", (a, b) => {
      if (a[2] != b[2]) return a[2] > b[2] ? 1 : -1;
      else return 0;
    }));
    if (settings.bommode == "grouped") {
      tr.appendChild(createColumnHeader("Quantity", "Quantity", (a, b) => {
        return a[3].length - b[3].length;
      }));
    }
  }
  bomhead.appendChild(tr);
}

function populateBomBody() {
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  if (settings.bommode == "netlist") {
    bomtable = pcbdata.nets.slice();
  } else {
    switch (settings.canvaslayout) {
      case 'F':
        bomtable = pcbdata.bom.F.slice();
        break;
      case 'FB':
        bomtable = pcbdata.bom.both.slice();
        break;
      case 'B':
        bomtable = pcbdata.bom.B.slice();
        break;
    }
    if (settings.bommode == "ungrouped") {
      // expand bom table
      expandedTable = []
      for (var bomentry of bomtable) {
        for (var ref of bomentry[3]) {
          expandedTable.push([1, bomentry[1], bomentry[2], [ref], bomentry[4], bomentry[5]]);
        }
      }
      bomtable = expandedTable;
    }
  }
  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry[3];
      }
      // Checkboxes
      for (var checkbox of settings.checkboxes) {
        if (checkbox) {
          td = document.createElement("TD");
          var input = document.createElement("input");
          input.type = "checkbox";
          input.onchange = createCheckboxChangeHandler(checkbox, references, tr);
          setBomCheckboxState(checkbox, input, references);
          if (input.checked && settings.darkenWhenChecked == checkbox) {
            tr.classList.add("checked");
          }
          td.appendChild(input);
          tr.appendChild(td);
        }
      }
      // References
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
      tr.appendChild(td);
      // Extra fields
      for (var i in config.extra_fields) {
        td = document.createElement("TD");
        td.innerHTML = highlightFilter(bomentry[4][i]);
        tr.appendChild(td);
      }
      // Value
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(bomentry[1]);
      tr.appendChild(td);
      // Footprint
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(bomentry[2]);
      tr.appendChild(td);
      if (settings.bommode == "grouped") {
        // Quantity
        td = document.createElement("TD");
        td.textContent = bomentry[3].length;
        tr.appendChild(td);
      }
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    tr.onmousemove = handler;
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT,
    {
      filter: filter,
      reflookup: reflookup,
      checkboxes: settings.checkboxes,
      bommode: settings.bommode,
    });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0, fp_b = 0, pads_f = 0, pads_b = 0, pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("bot").style.height = "";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("bot").style.height = "calc(100% - 80px)";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("bot").style.height = "calc(100% - 80px)";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
  }
  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum + 1].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").filter((e) => e);
  prepCheckboxes();
  populateBomTable();
  populateDarkenWhenCheckedOptions();
}

function setDarkenWhenChecked(value) {
  writeStorage("darkenWhenChecked", value);
  settings.darkenWhenChecked = value;
  populateBomTable();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateDarkenWhenCheckedOptions() {
  var container = document.getElementById("darkenWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "darkenWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "darkenWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setDarkenWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.darkenWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

document.onkeydown = function(e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

window.onload = function(e) {
  initUtils();
  initRender();
  initStorage();
  initDefaults();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  prepCheckboxes();
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////
 
///////////////////////////////////////////////
  </script>
</head>

<body>
<!-- USERHEADER -->
<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div style="float: right; height: 100%;">
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="highlightpin1Checkbox" type="checkbox" onchange="setHighlightPin1(this.checked)">
            Highlight first pin
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            <input id="crosshairCheckbox" type="checkbox" checked onchange="setShowCrosshair(this.checked)">
            Show Crosshair
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Darken when checked</div>
            <div id="darkenWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="fileinfodiv" style="overflow: auto;">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div id="bot" class="split" style="height: calc(100% - 80px)">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="copyToClipboard()"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- USERFOOTER -->
</body>

</html>
